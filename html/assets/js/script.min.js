function opentab(e,t){var n,i,o;for(i=document.getElementsByClassName("tabcontent"),n=0;n<i.length;n++)i[n].style.display="none";for(o=document.getElementsByClassName("tablinks"),n=0;n<o.length;n++)o[n].className=o[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}function init_collapse(){let e=document.getElementsByClassName("collapsible");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(function(){let e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"}))}function getinstructions(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{n.once("getinstructions",(t=>{e||(t.forEach((function(e){let t=document.getElementById("instructions_select"),n=document.createElement("option");t.appendChild(n),n.value=e.id,n.innerHTML=e.name})),t.forEach((function(e){let t=document.getElementById("instructions_select_box"),n=document.createElement("option");t.appendChild(n),n.value=e.id,n.innerHTML=e.name})),e=!0)}))}))}function getbox(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{n.once("getouterbox",(t=>{e||(t.forEach((function(e){let t=document.getElementById("outer_box_select"),n=document.createElement("option");t.appendChild(n),n.value=e.id,n.innerHTML=e.name})),t.forEach((function(e){let t=document.getElementById("box_select"),n=document.createElement("option");t.appendChild(n),n.value=e.id,n.innerHTML=e.name})),document.getElementById("box_select").value=1,document.getElementById("outer_box_select").value=1,e=!0)}))}))}function getinnerbox(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{n.once("getinnerbox",(t=>{if(!e){console.log(t);let n=document.getElementById("inner_box_container1");t.forEach((function(e){let t=document.createElement("div");t.classList.add("row"),n.appendChild(t);let i=document.createElement("div");i.classList.add("col-lg-12"),t.appendChild(i);let o=document.createElement("div");o.classList.add("row"),o.style.marginTop="1rem",o.style.marginBottom="1rem",i.appendChild(o);let l=document.createElement("div");l.classList.add("col-lg-6"),o.appendChild(l);let a=document.createElement("p");a.innerHTML=e.name,l.appendChild(a),l=document.createElement("div"),l.classList.add("col-lg-6"),o.appendChild(l);let r=document.createElement("div");r.classList.add("row"),l.appendChild(r),i=document.createElement("div"),i.classList.add("col-lg-12"),r.appendChild(i);let d=document.createElement("div");d.classList.add("input-group"),i.appendChild(d);let s=document.createElement("div");s.classList.add("row"),d.appendChild(s),l=document.createElement("div"),l.classList.add("col-lg-6"),s.appendChild(l),d=document.createElement("input"),d.classList.add("input-check-field"),d.classList.add("field_box"),d.setAttribute("data-id",e.id),d.type="checkbox",d.id=e.id,d.value=e.name,d.name=e.name,d.checked=!1,d.title="checked:"+d.checked,l.appendChild(d)})),e=!0}}))}))}function getitem_node(e,t){let n=!1;var i=location.host,o=io("http://"+i,{transports:["websocket"]});o.once("connect",(()=>{e==t&&o.emit("in_use_box_node",t),o.once(""+t,(i=>{console.log(1),console.log(i),console.log(e+", "+t),n||(i.forEach((function(t){let n=document.getElementById(e),i=document.createElement("div");i.classList.add("row"),n.appendChild(i);let l=document.createElement("div");l.classList.add("col-lg-12"),i.appendChild(l);let a=document.createElement("div");a.classList.add("row"),a.style.marginTop="1rem",a.style.marginBottom="1rem",l.appendChild(a);let r=document.createElement("div");r.classList.add("col-lg-6"),a.appendChild(r);let d=document.createElement("p");d.innerHTML=t.name,r.appendChild(d),r=document.createElement("div"),r.classList.add("col-lg-6"),a.appendChild(r);let s=document.createElement("div");s.classList.add("row"),r.appendChild(s),l=document.createElement("div"),l.classList.add("col-lg-12"),s.appendChild(l);let c=document.createElement("div");c.classList.add("input-group"),c.classList.add("plus-minus-input"),l.appendChild(c);let m=document.createElement("div");m.classList.add("row"),c.appendChild(m),r=document.createElement("div"),r.classList.add("col-lg-6"),m.appendChild(r);if(-1=="box_container1 item_container2".indexOf(e)){if(c=document.createElement("input"),c.classList.add("input-group-field"),c.classList.add("field_item"),c.type="number",c.name=t.name,c.value="0",c.placeholder="0",c.title="value","item_container1"==e){var u=t.total_quantity;o.emit("sql_read","SELECT * FROM item_box WHERE item_id='"+t.id+"'"),o.on("sql_rSELECT * FROM item_box WHERE item_id='"+t.id+"' AND NOT box_id='1'",(e=>{e.forEach((e=>{u-=parseInt(e.quantity)}))})),c.setAttribute("data-max",u),c.setAttribute("data-min",0),c.addEventListener("change",(()=>{parseInt(c.value)>u&&(c.value=u),parseInt(c.value)<0&&(c.value=0)}))}c.setAttribute("data-id",t.id),c.style.width="16rem",c.style.height="3rem",c.style.alignSelf="center",r.appendChild(c)}else c=document.createElement("input"),c.classList.add("field_item"),c.setAttribute("data-id",t.id),c.type="checkbox",c.id=t.id,c.value=t.name,c.name=t.name,c.checked=!1,r.appendChild(c)})),n=!0)}))}))}function getbox_node(e,t){let n=!1;var i=location.host,o=io("http://"+i,{transports:["websocket"]});o.once("connect",(()=>{o.once(t,(t=>{console.log(t),n||(t.forEach((t=>{let n=document.getElementById(e),i=document.createElement("div");i.classList.add("col-lg-12"),n.appendChild(i);let o=document.createElement("button");o.type="button",o.classList.add("collapsible"),o.classList.add("boxes"),o.innerHTML=t.name,i.appendChild(o);let l=document.createElement("div");l.classList.add("content"),l.id=t.id,l.style.display="none",i.appendChild(l),getitem_node(t.id,t.id)})),n=!0,init_collapse())}))}))}function getUnit(){var e=!1,t=!1,n=location.host,i=io("http://"+n,{transports:["websocket"]});i.once("connect",(()=>{i.once("getsize_Unit",(t=>{e||(t.forEach((function(e){let t=document.getElementById("unit_size"),n=document.createElement("option");t.appendChild(n),n.value=e.name,n.innerHTML=e.name})),e=!0)})),i.once("getweight_Unit",(e=>{t||(e.forEach((function(e){let t=document.getElementById("unit_weight"),n=document.getElementById("unit_box_weight"),i=document.createElement("option");t.appendChild(i),i.value=e.name,i.innerHTML=e.name;let o=document.createElement("option");n.appendChild(o),o.value=e.name,o.innerHTML=e.name})),t=!0)}))}))}function refresh(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{e||(n.emit("refresh",!0),n.once("reloaded",(t=>{e=!0,location.reload()})))}))}function additem(){var e=document.getElementById("item_name").value;document.getElementById("item_name").value="";var t=document.getElementById("box_select").value;document.getElementById("box_select").vlaue="";var n=parseInt(document.getElementById("instructions_select").value);document.getElementById("instructions_select").value="Choose";var i=parseFloat(document.getElementById("item_size").value);document.getElementById("item_size").value="";var o=document.getElementById("unit_size").value;document.getElementById("unit_size").value="mm";var l=parseFloat(document.getElementById("item_quantity").value);document.getElementById("item_quantity").value="";var a=document.getElementById("item_color").value;document.getElementById("item_color").value="#FFFFFF";var r=document.getElementById("item_pic").files,d=parseFloat(document.getElementById("item_weight").value);document.getElementById("item_weight").value="";var s=document.getElementById("unit_weight").value;document.getElementById("unit_weight").value="g";var c=parseFloat(document.getElementById("item_price").value);if(document.getElementById("item_price").value="",""!=e){var m=location.host,u=io("http://"+m,{transports:["websocket"]});u.once("connect",(()=>{u.once("getsize_Unit",(m=>{u.once("getweight_Unit",(p=>{m.forEach((e=>{o===e.name&&(i*=parseFloat(e.multiplicator))})),p.forEach((e=>{s===e.name&&(d*=parseFloat(e.multiplicator))})),u.emit("item_data",[e,[t],n,[i],a,[l],[d],[c]]),u.once("successi",(t=>{for(let n=0;n<r.length;n++){let i=new FileReader;i.addEventListener("loadend",(function(){let n=i.result;u.emit("setitempic",[t,e,n.length]),console.log(n.length),u.on("pready"+t+"&"+e,(i=>{u.emit("pback"+t+"&"+e,[i,n.slice(0+9900*i,9900*(i+1))]),i+1>=n.size/9900&&console.log("allsended")}))})),i.readAsDataURL(r[n])}u.once("ptransferred"+t+!1+"&"+e,(n=>{!1===n&&(u.emit("ptransferred"+t+!0+"&"+e,!0),u.removeAllListeners("pready"+t+"&"+e))})),u.once("pfin"+t+"&"+e,(e=>{document.getElementById("item_pic_f").reset(),location.reload()}))}))}))}))}))}}function addbox(e){console.log(location);var t=document.getElementById("box_name").value;document.getElementById("box_name").value="";var n=document.getElementById("outer_box_select").value;document.getElementById("outer_box_select").value=1;var i=parseFloat(document.getElementById("box_weight").value);document.getElementById("box_weight").value="";var o=document.getElementById("unit_box_weight").value;document.getElementById("unit_box_weight").value="g";var l=document.getElementById(e),a=l.getElementsByClassName("field_item"),r=l.getElementsByClassName("field_box"),d=document.getElementById("box_color").value;document.getElementById("box_color").value="#FFFFFF";var s=document.getElementById("box_pic").files,c=document.getElementById("location_name").value;document.getElementById("location_name").value="";var m=[];if(""!=t){Array.prototype.forEach.call(a,(function(e){let t=e.value;e.value=0;let n=e.getAttribute("data-id"),i=e.getAttribute("data-min"),o=e.getAttribute("data-max");var l=!1;""!=i?parseInt(i)<=t&&(""!=o?parseInt(o)>=t&&(l=!0):l=!0):""!=o?parseInt(o)>=t&&(l=!0):l=!0,l&&(m=[...m,n,t])}));var u=[];Array.prototype.forEach.call(r,(function(e){let t=e.getAttribute("data-id");e.checked&&(u=[...u,t])})),console.log(location),console.log(location.host);var p=location.host;console.log(p);var h=io("http://"+p,{transports:["websocket"]});h.once("connect",(()=>{h.once("getweight_Unit",(e=>{e.forEach((e=>{o===e.name&&(i*=parseFloat(e.multiplicator))})),h.emit("box_data",[t,n,u,m,d,i,c]),h.once("successb",(e=>{for(let n=0;n<s.length;n++){let i=s[n].match(/.{1,9900}(\s|$)/g);h.emit("setboxpic",[e,t,i.length]);for(let n=0;n<i.length;n++)h.once("pready"+e+"&"+t,(n=>{h.emit("pback"+e+"&"+t,[n[0],n[1],i[n[1]]])}))}document.getElementById("box_pic_f").reset()}))}))}))}}function addinstructions(e){var t=document.getElementById("instructions_name").value;document.getElementById("instructions_name").value="";var n,i=document.getElementById("instruction_file").files;n=document.getElementById(e).getElementsByClassName("field");var o=[];if(""!=t&&n.length>0){Array.prototype.forEach.call(n,(function(e){let t=e.checked;if(e.checked=!1,t){let t=e.getAttribute("data-id");o=[...o,t]}}));var l=location.host,a=io("http://"+l,{transports:["websocket"]});a.once("connect",(()=>{a.emit("instruction_data",[t,o,i,i.length]),a.once("successinst",(e=>{document.getElementById("instructions_f").reset(),location.reload()}))}))}}var urlp=[];if(-1!=location.toString().indexOf("?"))for(s=location.toString().split("?"),s=s[1].split("&"),i=0;i<s.length;i++)-1!=s[i].indexOf("=")?(u=s[i].split("="),urlp[u[0]]=u[1]):urlp[s[i]]="";var url=document.URL,id=-1;function getid(){if((null!=parseInt(urlp.id)||""!=urlp.id)&&parseInt(urlp.id)>=0)return id=parseInt(urlp.id),init_f(id),id;if(""==urlp.n&&null==urlp.n&&""==urlp.name&&null==urlp.name)return nofile(),-1;var e=location.host,t=io("http://"+e,{transports:["websocket"]});t.on("connect",(()=>{let e=urlp.n||urlp.name;e="SELECT * FROM box_group WHERE name='"+e+"'",t.emit("sql_read",e),t.on("sql_r"+e,(e=>{e.forEach((e=>{if(e.name===urlp.n||e.name===urlp.name)return id=e.id,init_f(id),id}))}))}))}function init(){getid(),init_picture()}function init_f(e){if(e>=1){var t=location.host,n=io("http://"+t,{transports:["websocket"]});n.on("connect",(()=>{n.emit("getBoxgroup_data",e),n.on("getweight_Unit",(t=>{n.on("box_group"+e,(o=>{if(0!=o.length){console.log(o);let e=0,l=0,a=[];document.getElementById("total_items").innerHTML=o.length,o.forEach((t=>{null!=t.i_weight&&(e+=t.i_weight),a.includes(t.b_id)||(e+=t.b_weight),null!=t.i_price&&(l+=t.i_price),document.getElementById("box_group_id").innerHTML=t.bg_id,document.getElementById("box_group_name").innerHTML=t.bg_name,document.getElementById("box_group_img").alt=t.bg_name,document.getElementById("box_group_location").innerHTML=t.bg_location,null!=t.bg_picture?(document.getElementById("box_group_img").src=t.bg_picture,document.getElementById("box_group_picture").innerHTML=t.bg_picture):document.getElementById("box_group_picture").innerHTML="undefined",null!=t.bg_color?(document.getElementById("color_row").style.backgroundColor=t.bg_color,document.getElementById("box_group_color").innerHTML=t.bg_color,"#ffffff"===t.bg_color?document.getElementById("box_group_color").style.color="#000000":document.getElementById("box_group_color").style.color=t.bg_color):document.getElementById("box_group_color").innerHTML="#000000"})),e+=o[0].b_weight;let r=[],d=[],s=!1;if(i=parseFloat(e),s=!1,null!=t?t.forEach((e=>{r=[...r,""+i/parseFloat(e.multiplicator)],d=[...d,e],s=!0})):(n.emit("refresh",!0),n.on("reloaded",(e=>{n.on("getweight_Unit",(e=>{null!=e&&e.forEach((e=>{r=[...r,""+i/parseFloat(e.multiplicator)],d=[...d,e],s=!0}))}))}))),s){let e=0;for(let t=0;t<r.length;t++)r[e].length>r[t].length&&(e=t);document.getElementById("total_weight").innerHTML=i/parseFloat(t[e].multiplicator),document.getElementById("total_weight_unit").innerHTML=t[e].name}else console.log("Unit konnte nicht geladen werden."),document.getElementById("total_weight").innerHTML=values.size,document.getElementById("total_weight_unit").innerHTML="g";document.getElementById("total_price").innerHTML=l,document.getElementById("total_box").innerHTML=0,init_tab_links(o)}else document.getElementById("body").style.display="none",document.getElementById("html").innerHTML="The item with the id: "+e+" doesn't exist"}))}))}))}}function nofile(){document.write("opps this doesn't exist - 404  -  (tipp: use /box_group?id=[item_id])")}function init_picture(){var e=document.getElementById("myModal"),t=document.getElementById("box_group_img"),n=document.getElementById("img01"),i=document.getElementById("caption");t.onclick=function(){e.style.display="block",n.src=this.src,i.innerHTML=this.alt},document.getElementsByClassName("close")[0].onclick=function(){e.style.display="none"}}function init_tab_links(e){let t,n=[],i=document.getElementById("tablinks_div");e.forEach((e=>{if(n.includes(e.b_id))init_item_row(t,e);else{n=[...n,e.b_id];let o=document.createElement("button");o.type="button",o.classList.add("collapsible"),o.innerHTML=e.b_name,o.style.backgroundColor="#FFFFFF",i.appendChild(o),t=document.createElement("div"),t.classList.add("content"),t.id=e.b_name,t.setAttribute("data-id",e.b_id),t.style.display="none",i.append(t),init_item_row(t,e),init_collapse(o)}})),document.getElementById("total_box").innerHTML=n.length}function init_item_row(e,t){let n=document.createElement("div");n.classList.add("row"),e.appendChild(n);let i=document.createElement("a");i.href="http://"+location.host+"/item?id="+t.i_id,"#ffffff"===t.i_color?i.style.color="#000000":i.style.color=t.i_color,i.style.textDecoration="none",i.style.width="100%",n.appendChild(i);let o=document.createElement("div");o.classList.add("col-lg-12"),o.id=t.i_name,i.appendChild(o),n=document.createElement("div"),n.classList.add("row"),n.style.marginTop="1rem",o.appendChild(n);let l=document.createElement("div");l.classList.add("col-lg-6"),n.appendChild(l);let a=document.createElement("p");a.innerHTML=t.i_name,l.appendChild(a),l=document.createElement("div"),l.classList.add("col-lg-6"),n.appendChild(l),a=document.createElement("p"),a.innerHTML=t.ib_quantity,l.appendChild(a)}function init_collapse(e){e.addEventListener("click",(function(){let e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"}))}function refresh(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.on("connect",(()=>{e||(n.emit("refresh",!0),n.on("reloaded",(t=>{e=!0,location.reload()})))}))}function change_box_group_name(e){if("true"===e){var t=document.getElementById("box_group_name_edit").value;if(document.getElementById("box_group_name").value=t,document.getElementById("box_group_name_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{i.emit("sql_read","SELECT * FROM box_group WHERE name='"+t+"'"),i.on("sql_rSELECT * FROM box_group WHERE name='"+t+"'",(e=>{if(e.length<=0){let e=[];e=["UPDATE box_group SET name ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.on("sql_i"+e,(e=>{location.reload()}))}else console.log("Name already exist")}))}))}else location.reload()}else{document.getElementById("edit_pen_name").disabled=!0,document.getElementById("edit_pen_name").style.display="none",document.getElementById("edit_save_name").style.display="block",document.getElementById("edit_save_name").disabled=!0;let e=document.createElement("input");e.type="text",e.id="box_group_name_edit",e.style.width="16rem",e.style.height="3rem",e.title="box group name",e.placeholder="name",document.getElementById("box_group_name").style.display="none",document.getElementById("box_group_name").parentElement.appendChild(e)}}function change_box_group_location(e){if("true"===e){var t=document.getElementById("box_group_location_edit").value;if(document.getElementById("box_group_location").value=t,document.getElementById("box_group_location_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{let e=[];e=["UPDATE box_group SET location ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.on("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_location").disabled=!0,document.getElementById("edit_pen_location").style.display="none",document.getElementById("edit_save_location").style.display="block",document.getElementById("edit_save_location").disabled=!0;let e=document.createElement("input");e.type="text",e.id="box_group_location_edit",e.style.width="16rem",e.style.height="3rem",e.title="box group location",e.placeholder="location",document.getElementById("box_group_location").style.display="none",document.getElementById("box_group_location").parentElement.appendChild(e)}}function change_box_group_color(e){if("true"===e){var t=document.getElementById("box_group_color_edit").value;if(document.getElementById("box_group_color_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{let e=[];e=["UPDATE box_group SET color ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.on("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_color").disabled=!0,document.getElementById("edit_pen_color").style.display="none",document.getElementById("edit_save_color").style.display="block",document.getElementById("edit_save_color").disabled=!0;let e=document.createElement("input");e.type="color",e.id="box_group_color_edit",e.style.width="16rem",e.style.height="3rem",e.title="box group color",e.placeholder="color",e.value=document.getElementById("box_group_color").innerHTML,document.getElementById("box_group_color").style.display="none",document.getElementById("box_group_color").parentElement.appendChild(e)}}function change_box_group_picture(e){if("true"===e){var t=document.getElementById("box_group_pic_edit").files;if(""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{let e=[];i.emit("setpicture",["boxgroup?id="+id+".jpg",t[0]]),e=["UPDATE box_group SET picture ='boxgroup?id="+id+".jpg' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.on("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_picture").disabled=!0,document.getElementById("edit_pen_picture").style.display="none",document.getElementById("edit_save_picture").style.display="block",document.getElementById("edit_save_picture").disabled=!0;let e=document.createElement("input");e.type="file",e.accept=".jpg",e.id="box_group_pic_edit",e.style.width="16rem",e.style.height="3rem",e.title="box group pic",e.placeholder="pic",document.getElementById("box_group_picture").style.display="none",document.getElementById("box_group_picture").parentElement.appendChild(e)}}urlp=[];if(-1!=location.toString().indexOf("?"))for(s=location.toString().split("?"),s=s[1].split("&"),i=0;i<s.length;i++)-1!=s[i].indexOf("=")?(u=s[i].split("="),urlp[u[0]]=u[1]):urlp[s[i]]="";url=document.URL,id=-1;function getid(){if((null!=parseInt(urlp.id)||""!=parseInt(urlp.id))&&parseInt(urlp.id)>=0)return id=parseInt(urlp.id),init_f(id),id;if(""==urlp.n&&null==urlp.n&&""==urlp.name&&null==urlp.name)return nofile(),-1;var e=location.host,t=io("http://"+e,{transports:["websocket"]});t.on("connect",(()=>{let e=urlp.n||urlp.name;e="SELECT * FROM Box WHERE name='"+e+"'",t.emit("sql_read",e),t.on("sql_r"+e,(e=>{e.forEach((e=>{if(e.name===urlp.n||e.name===urlp.name)return id=e.id,init_f(id),id}))}))}))}function init(){getid(),init_picture()}function init_f(e){if(e>=1){var t=location.host,n=io("http://"+t,{transports:["websocket"]});n.on("connect",(()=>{n.emit("getBox_data",e),n.on("getweight_Unit",(t=>{n.on("box"+e,(o=>{if(0!=o.length){let e=0,l=0;document.getElementById("total_items").innerHTML=o.length,o.forEach((o=>{null!=o.i_weight&&(e+=o.i_weight),null!=o.i_price&&(l+=o.i_price),document.getElementById("box_id").innerHTML=o.b_id,document.getElementById("box_name").innerHTML=o.b_name,document.getElementById("box_img").alt=o.b_name,n.emit("getBoxgroup_data",o.bg_id),n.on("box_group"+o.bg_id,(e=>{e.some((e=>(document.getElementById("box_bg").innerHTML=e.bg_name,document.getElementById("box_bg").href="http://"+location.host+"/box_group?id="+e.bg_id,!0)))}));let a=[],r=[],d=!1;if(i=parseFloat(o.b_weight),d=!1,null!=t?t.forEach((e=>{a=[...a,""+i/parseFloat(e.multiplicator)],r=[...r,e],d=!0})):(n.emit("refresh",!0),n.on("reloaded",(e=>{n.on("getweight_Unit",(e=>{null!=e&&e.forEach((e=>{a=[...a,""+i/parseFloat(e.multiplicator)],r=[...r,e],d=!0}))}))}))),d){let e=0;for(let t=0;t<a.length;t++)a[e].length>a[t].length&&(e=t);document.getElementById("box_weight").innerHTML=i/parseFloat(t[e].multiplicator),document.getElementById("box_weight_unit").innerHTML=t[e].name}else console.log("Unit konnte nicht geladen werden."),document.getElementById("box_weight").innerHTML=o.size,document.getElementById("box_weight_unit").innerHTML="g";document.getElementById("box_bg").alt=o.b_name,null!=o.b_picture?(document.getElementById("box_img").src=o.b_picture,document.getElementById("box_picture").innerHTML=o.b_picture):document.getElementById("box_picture").innerHTML="undefined",null!=o.b_color?(document.getElementById("color_row").style.backgroundColor=o.b_color,document.getElementById("box_color").innerHTML=o.b_color,"#ffffff"===o.b_color?document.getElementById("box_color").style.color="#000000":document.getElementById("box_color").style.color=o.b_color):document.getElementById("box_color").innerHTML="#000000"})),e+=o[0].b_weight;let a=[],r=[],d=!1;if(i=parseFloat(e),d=!1,null!=t?t.forEach((e=>{a=[...a,""+i/parseFloat(e.multiplicator)],r=[...r,e],d=!0})):(n.emit("refresh",!0),n.on("reloaded",(e=>{n.on("getweight_Unit",(e=>{null!=e&&e.forEach((e=>{a=[...a,""+i/parseFloat(e.multiplicator)],r=[...r,e],d=!0}))}))}))),d){let e=0;for(let t=0;t<a.length;t++)a[e].length>a[t].length&&(e=t);document.getElementById("total_weight").innerHTML=i/parseFloat(t[e].multiplicator),document.getElementById("total_weight_unit").innerHTML=t[e].name}else console.log("Unit konnte nicht geladen werden."),document.getElementById("total_weight").innerHTML=values.size,document.getElementById("total_weight_unit").innerHTML="g";document.getElementById("total_price").innerHTML=l,init_tab_links(o)}else document.getElementById("body").style.display="none",document.getElementById("html").innerHTML="The item with the id: "+e+" doesn't exist"}))}))}))}}function nofile(){document.write("opps this doesn't exist - 404  -  (tipp: use /box?id=[item_id])")}function init_picture(){var e=document.getElementById("myModal"),t=document.getElementById("box_img"),n=document.getElementById("img01"),i=document.getElementById("caption");t.onclick=function(){e.style.display="block",n.src=this.src,i.innerHTML=this.alt},document.getElementsByClassName("close")[0].onclick=function(){e.style.display="none"}}function init_tab_links(e){let t,n=[],i=document.getElementById("tablinks_div");e.forEach((e=>{if(n.includes(e.b_id))init_item_row(t,e);else{n=[...n,e.b_id];let o=document.createElement("button");o.type="button",o.classList.add("collapsible"),o.innerHTML=e.b_name,o.style.backgroundColor="#FFFFFF",i.appendChild(o),t=document.createElement("div"),t.classList.add("content"),t.id=e.b_name,t.setAttribute("data-id",e.b_id),t.style.display="none",i.append(t),init_item_row(t,e),init_collapse(o)}}))}function init_item_row(e,t){let n=document.createElement("div");n.classList.add("row"),e.appendChild(n);let i=document.createElement("a");i.href="http://"+location.host+"/item?id="+t.i_id,"#ffffff"===t.i_color?i.style.color="#000000":i.style.color=t.i_color,i.style.textDecoration="none",i.style.width="100%",n.appendChild(i);let o=document.createElement("div");o.classList.add("col-lg-12"),o.id=t.i_name,i.appendChild(o),n=document.createElement("div"),n.classList.add("row"),n.style.marginTop="1rem",o.appendChild(n);let l=document.createElement("div");l.classList.add("col-lg-6"),n.appendChild(l);let a=document.createElement("p");a.innerHTML=t.i_name,l.appendChild(a),l=document.createElement("div"),l.classList.add("col-lg-6"),n.appendChild(l),a=document.createElement("p"),a.innerHTML=t.ib_quantity,l.appendChild(a)}function init_collapse(e){e.addEventListener("click",(function(){let e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"}))}function refresh(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.on("connect",(()=>{e||(n.emit("refresh",!0),n.on("reloaded",(t=>{e=!0,location.reload()})))}))}function change_box_name(e){if("true"===e){var t=document.getElementById("box_name_edit").value;if(document.getElementById("box_name").value=t,document.getElementById("box_name_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{i.emit("sql_read","SELECT * FROM box WHERE name='"+t+"'"),i.on("sql_rSELECT * FROM box WHERE name='"+t+"'",(e=>{if(e.length<=0){let e=[];e=["UPDATE box SET name ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.on("sql_i"+e,(e=>{location.reload()}))}else console.log("Name already exist")}))}))}else location.reload()}else{document.getElementById("edit_pen_name").disabled=!0,document.getElementById("edit_pen_name").style.display="none",document.getElementById("edit_save_name").style.display="block",document.getElementById("edit_save_name").disabled=!0;let e=document.createElement("input");e.type="text",e.id="box_name_edit",e.style.width="16rem",e.style.height="3rem",e.title="box name",e.placeholder="name",document.getElementById("box_name").style.display="none",document.getElementById("box_name").parentElement.appendChild(e)}}function change_box_bg(e){if("true"===e){var t=document.getElementById("bg").value;if(document.getElementById("bg").value=t,""!=t){var n=location.host;(i=io("http://"+n,{transports:["websocket"]})).on("connect",(()=>{i.on("getboxgroup",(e=>{e.forEach((e=>{if(t===e.name){let t=[];t=["UPDATE box SET box_group_id ='"+e.id+"' WHERE id = '"+id+"'",t],i.emit("sql_insert",t),i.on("sql_i"+t,(e=>{location.reload()}))}}))}))}))}else location.reload()}else{document.getElementById("edit_pen_bg").disabled=!0,document.getElementById("edit_pen_bg").style.display="none",document.getElementById("edit_save_bg").style.display="block",document.getElementById("edit_save_bg").disabled=!1;var i;n=location.host;(i=io("http://"+n,{transports:["websocket"]})).on("connect",(()=>{i.on("getboxgroup",(e=>{console.log(e);let t=document.createElement("form");t.id="box_bg_edit";let n=document.createElement("label");n.htmlFor="bg",t.appendChild(n);let i=document.createElement("select");i.id="bg",i.name="bg",i.style.width="5rem",i.style.height="3rem",i.value=document.getElementById("box_bg").innerHTML,n.appendChild(i),e.forEach((e=>{let t=document.createElement("option");i.appendChild(t),t.value=e.name,t.innerHTML=e.name})),document.getElementById("box_bg").style.display="none",document.getElementById("box_bg").parentElement.appendChild(t)}))}))}}function change_box_color(e){if("true"===e){var t=document.getElementById("box_color_edit").value;if(document.getElementById("box_color_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{let e=[];e=["UPDATE box SET color ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.on("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_color").disabled=!0,document.getElementById("edit_pen_color").style.display="none",document.getElementById("edit_save_color").style.display="block",document.getElementById("edit_save_color").disabled=!0;let e=document.createElement("input");e.type="color",e.id="box_color_edit",e.style.width="16rem",e.style.height="3rem",e.title="box color",e.placeholder="color",e.value=document.getElementById("box_color").innerHTML,document.getElementById("box_color").style.display="none",document.getElementById("box_color").parentElement.appendChild(e)}}function change_box_picture(e){if("true"===e){var t=document.getElementById("box_pic_edit").files;if(""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{let e=[];i.emit("setpicture",["box?id="+id+".jpg",t[0]]),e=["UPDATE box SET picture ='box?id="+id+".jpg' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.on("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_picture").disabled=!0,document.getElementById("edit_pen_picture").style.display="none",document.getElementById("edit_save_picture").style.display="block",document.getElementById("edit_save_picture").disabled=!0;let e=document.createElement("input");e.type="file",e.accept=".jpg",e.id="box_pic_edit",e.style.width="16rem",e.style.height="3rem",e.title="box pic",e.placeholder="pic",document.getElementById("box_picture").style.display="none",document.getElementById("box_picture").parentElement.appendChild(e)}}function change_box_weight(e){if("true"===e){var t=document.getElementById("box_weight_edit").value;document.getElementById("box_weight").value=t,document.getElementById("box_weight_edit").value=t;var n=document.getElementById("weight_unit").value;if(document.getElementById("weight_unit").value="g",""!=t){var i=location.host;(o=io("http://"+i,{transports:["websocket"]})).on("connect",(()=>{o.on("getweight_Unit",(e=>{e.forEach((e=>{if(n===e.name){t=~~(1e3*(t*=parseFloat(e.multiplicator))),t/=1e3;let n=[];console.log(t),n=["UPDATE box SET weight ='"+t+"' WHERE id = '"+id+"'",n],o.emit("sql_insert",n),o.on("sql_i"+n,(e=>{location.reload()}))}}))}))}))}else location.reload()}else{document.getElementById("edit_pen_weight").disabled=!0,document.getElementById("edit_pen_weight").style.display="none",document.getElementById("edit_save_weight").style.display="block",document.getElementById("edit_save_weight").disabled=!1;let e=document.createElement("input");e.type="number",e.id="box_weight_edit",e.style.width="16rem",e.style.height="3rem",e.title="box weight",e.placeholder="0",document.getElementById("box_weight").style.display="none",document.getElementById("box_weight").parentElement.appendChild(e);var o;i=location.host;(o=io("http://"+i,{transports:["websocket"]})).on("connect",(()=>{o.on("getweight_Unit",(e=>{let t=document.createElement("form");t.id="box_unit_edit";let n=document.createElement("label");n.htmlFor="weight_unit",t.appendChild(n);let i=document.createElement("select");i.id="weight_unit",i.name="weight unit",i.style.width="5rem",i.style.height="3rem",n.appendChild(i),e.forEach((e=>{let t=document.createElement("option");i.appendChild(t),t.value=e.name,t.innerHTML=e.name})),document.getElementById("box_weight_unit").style.display="none",document.getElementById("box_weight_unit").parentElement.appendChild(t)}))}))}}var sort_table=0,arrowup="&#9650",arrowdown="&#9660";function onChange(){switch(document.getElementById("table-container").innerHTML=null,document.getElementById("category").value){case"Item":item_overview();break;case"Box":box_overview();break;case"Box_group":box_group_overview()}}function chngsort(e,t,n){Array.prototype.forEach.call(document.getElementsByTagName("th"),(e=>{-1!=e.innerHTML.indexOf("&")&&(e.innerHTML=e.innerHTML.substring(0,e.innerHTML.indexOf("&")-1))})),sort_table=sort_table==t?e:t,onChange()}function item_overview(){var e=location.host,t=io("http://"+e,{transports:["websocket"]});let n="SELECT * FROM item ";switch(sort_table){case 0:n+="ORDER BY item.id ASC";break;case 1:n+="ORDER BY item.id DESC";break;case 2:n+="ORDER BY item.name ASC";break;case 3:n+="ORDER BY item.name DESC";break;case 4:n+="ORDER BY item.instructions_id ASC";break;case 5:n+="ORDER BY item.instructions_id DESC";break;case 6:n+="ORDER BY item.size ASC";break;case 7:n+="ORDER BY item.size DESC";break;case 8:n+="ORDER BY item.total_quantity ASC";break;case 9:n+="ORDER BY item.total_quantity DESC";break;case 10:n+="ORDER BY item.price ASC";break;case 11:n+="ORDER BY item.price DESC";break;case 12:n+="ORDER BY item.weight ASC";break;case 13:n+="ORDER BY item.weight DESC"}t.once("connect",(()=>{t.emit("sql_read",n),t.once("sql_r"+n,(e=>{if(null==e||""==e){let e=document.getElementById("table-container"),t=document.createElement("p");t.innerHTML="Nothing for that object found",e.appendChild(t)}else{let t=document.getElementById("table-container"),n=document.createElement("table");n.style.width="100%",t.appendChild(n);let i=document.createElement("tr");n.appendChild(i);let o=document.createElement("th");o.innerHTML="id",o.onclick=function(){chngsort(0,1,"id")},o.id="id",0==sort_table?o.innerHTML="id"+arrowup:1==sort_table&&(o.innerHTML="id"+arrowdown),i.appendChild(o);let l=document.createElement("th");l.innerHTML="name",l.onclick=function(){chngsort(2,3,"name")},l.id="name",2==sort_table?l.innerHTML="name"+arrowup:3==sort_table&&(l.innerHTML="name"+arrowdown),i.appendChild(l);let a=document.createElement("th");a.innerHTML="Instruction",a.onclick=function(){chngsort(4,5,"inst")},a.id="inst",4==sort_table?a.innerHTML="Instruction"+arrowup:5==sort_table&&(a.innerHTML="Instruction"+arrowdown),i.appendChild(a);let r=document.createElement("th");r.innerHTML="size (in cm) ",r.onclick=function(){chngsort(6,7,"size")},r.id="size",6==sort_table?r.innerHTML="size (in cm) "+arrowup:7==sort_table&&(r.innerHTML="size (in cm) "+arrowdown),i.appendChild(r);let d=document.createElement("th");d.innerHTML="total quantity",d.onclick=function(){chngsort(8,9,"total")},d.id="total",8==sort_table?d.innerHTML="total quantity"+arrowup:9==sort_table&&(d.innerHTML="total quantity"+arrowdown),i.appendChild(d);let s=document.createElement("th");s.innerHTML="price",s.onclick=function(){chngsort(10,11,"price")},s.id="price",10==sort_table?s.innerHTML="price"+arrowup:11==sort_table&&(s.innerHTML="price"+arrowdown),i.appendChild(s);let c=document.createElement("th");c.innerHTML="weight (in kg) ",c.onclick=function(){chngsort(12,13,"weight")},c.id="weight",12==sort_table?c.innerHTML="weight (in kg) "+arrowup:13==sort_table&&(c.innerHTML="weight (in kg) "+arrowdown),i.appendChild(c),e.forEach((e=>{let t=document.createElement("tr");n.appendChild(t);let i=document.createElement("td"),o=document.createElement("a");o.style.textDecoration="none",o.href="http://"+location.host+"/item?id="+e.id,o.innerHTML=e.id,i.appendChild(o),t.appendChild(i);let l=document.createElement("td");if(""!=e.name&&""!=e.name&&null!=e.name){let t=document.createElement("a");t.style.textDecoration="none",t.href="http://"+location.host+"/item?id="+e.id,t.innerHTML=e.name,l.appendChild(t)}t.appendChild(l);let a=document.createElement("td");if(""!=e.instruction_id&&" "!=e.instruction_id&&null!=e.instruction_id){let t=document.createElement("a");t.style.textDecoration="none",t.href="http://"+location.host+"/instruction?id="+e.instruction_id,t.innerHTML=e.instruction_id,a.appendChild(t)}t.appendChild(a);let r=document.createElement("td");r.innerHTML=e.size,t.appendChild(r);let d=document.createElement("td");d.innerHTML=e.total_quantity,t.appendChild(d);let s=document.createElement("td");s.innerHTML=e.price,t.appendChild(s);let c=document.createElement("td");c.innerHTML=e.weight,t.appendChild(c)}))}}))}))}function box_overview(){var e=location.host,t=io("http://"+e,{transports:["websocket"]});let n="SELECT * FROM box ";switch(sort_table){case 0:n+="ORDER BY box.id ASC";break;case 1:n+="ORDER BY box.id DESC";break;case 2:n+="ORDER BY box.name ASC";break;case 3:n+="ORDER BY box.name DESC";break;case 4:n+="ORDER BY box.box_group_id ASC";break;case 5:n+="ORDER BY box.box_group_id DESC";break;case 6:n+="ORDER BY item.weight ASC";break;case 7:n+="ORDER BY item.weight DESC"}t.once("connect",(()=>{t.emit("sql_read",n),t.once("sql_r"+n,(e=>{if(null==e||""==e){let e=document.getElementById("table-container"),t=document.createElement("p");t.innerHTML="Nothing for that object found",e.appendChild(t)}else{let t=document.getElementById("table-container"),n=document.createElement("table");n.style.width="100%",t.appendChild(n);let i=document.createElement("tr");n.appendChild(i);let o=document.createElement("th");o.innerHTML="id",o.onclick=function(){chngsort(0,1,"id")},o.id="id",0==sort_table?o.innerHTML="id"+arrowup:1==sort_table&&(o.innerHTML="id"+arrowdown),i.appendChild(o);let l=document.createElement("th");l.innerHTML="name",l.onclick=function(){chngsort(2,3,"name")},l.id="name",2==sort_table?l.innerHTML="name"+arrowup:3==sort_table&&(l.innerHTML="name"+arrowdown),i.appendChild(l);let a=document.createElement("th");a.innerHTML="Box_group",a.onclick=function(){chngsort(4,5,"bg")},a.id="bg",4==sort_table?a.innerHTML="Box_group"+arrowup:5==sort_table&&(a.innerHTML="Box_group"+arrowdown),i.appendChild(a);let r=document.createElement("th");r.innerHTML="weight",r.onclick=function(){chngsort(6,7,"weight")},r.id="weight",12==sort_table?r.innerHTML="weight"+arrowup:13==sort_table&&(r.innerHTML="weight"+arrowdown),i.appendChild(r),e.forEach((e=>{let t=document.createElement("tr");n.appendChild(t);let i=document.createElement("td"),o=document.createElement("a");o.style.textDecoration="none",o.href="http://"+location.host+"/box?id="+e.id,o.innerHTML=e.id,i.appendChild(o),t.appendChild(i);let l=document.createElement("td");if(""!=e.name&&""!=e.name&&null!=e.name){let t=document.createElement("a");t.style.textDecoration="none",t.href="http://"+location.host+"/box?id="+e.id,t.innerHTML=e.name,l.appendChild(t)}t.appendChild(l);let a=document.createElement("td");if(""!=e.instruction_id&&" "!=e.instruction_id&&null!=e.instruction_id){let t=document.createElement("a");t.style.textDecoration="none",t.href="http://"+location.host+"/instruction?id="+e.instruction_id,t.innerHTML=e.instruction_id,a.appendChild(t)}t.appendChild(a);let r=document.createElement("td");r.innerHTML=e.weight,t.appendChild(r)}))}}))}))}function box_group_overview(){var e=location.host,t=io("http://"+e,{transports:["websocket"]});let n="SELECT * FROM box_group ";switch(sort_table){case 0:n+="ORDER BY box_group.id ASC";break;case 1:n+="ORDER BY box_group.id DESC";break;case 2:n+="ORDER BY box_group.name ASC";break;case 3:n+="ORDER BY box_group.name DESC";break;case 4:n+="ORDER BY box_group.location ASC";break;case 5:n+="ORDER BY box_group.location DESC"}t.once("connect",(()=>{t.emit("sql_read",n),t.once("sql_r"+n,(e=>{if(null==e||""==e){let e=document.getElementById("table-container"),t=document.createElement("p");t.innerHTML="Nothing for that object found",e.appendChild(t)}else{let t=document.getElementById("table-container"),n=document.createElement("table");n.style.width="100%",t.appendChild(n);let i=document.createElement("tr");n.appendChild(i);let o=document.createElement("th");o.innerHTML="id",o.onclick=function(){chngsort(0,1,"id")},o.id="id",0==sort_table?o.innerHTML="id"+arrowup:1==sort_table&&(o.innerHTML="id"+arrowdown),i.appendChild(o);let l=document.createElement("th");l.innerHTML="name",l.onclick=function(){chngsort(2,3,"name")},l.id="name",2==sort_table?l.innerHTML="name"+arrowup:3==sort_table&&(l.innerHTML="name"+arrowdown),i.appendChild(l);let a=document.createElement("th");a.innerHTML="location",a.onclick=function(){chngsort(4,5,"location")},a.id="location",4==sort_table?a.innerHTML="location"+arrowup:5==sort_table&&(a.innerHTML="location"+arrowdown),i.appendChild(a),e.forEach((e=>{let t=document.createElement("tr");n.appendChild(t);let i=document.createElement("td"),o=document.createElement("a");o.style.textDecoration="none",o.href="http://"+location.host+"/box?id="+e.id,o.innerHTML=e.id,i.appendChild(o),t.appendChild(i);let l=document.createElement("td");if(""!=e.name&&""!=e.name&&null!=e.name){let t=document.createElement("a");t.style.textDecoration="none",t.href="http://"+location.host+"/box?id="+e.id,t.innerHTML=e.name,l.appendChild(t)}t.appendChild(l);let a=document.createElement("td");a.innerHTML=e.location,t.appendChild(a)}))}}))}))}function opentab(e,t){if(e.currentTarget.classList.contains("active"))e.currentTarget.className=e.currentTarget.className.replace(" active",""),document.getElementById(t).style.display="none",document.getElementById("edit_box").style.display="none",document.getElementById("edit_pen_box").href="";else{var n,i,o;for(i=document.getElementsByClassName("tabcontent"),n=0;n<i.length;n++)i[n].style.display="none";for(o=document.getElementsByClassName("tablinks"),n=0;n<o.length;n++)o[n].className=o[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active",document.getElementById("edit_box").style.display="block",document.getElementById("edit_pen_box").href="http://"+location.host+"/box_group?id="+e.currentTarget.getAttribute("data-id")}}function init_collapse(e){e.addEventListener("click",(function(){let e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"}))}function refresh(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.on("connect",(()=>{e||(n.emit("refresh",!0),n.on("reloaded",(t=>{e=!0,location.reload()})))}))}function init_tab_links(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.on("connect",(()=>{n.on("getboxgroupname",(t=>{if(!e){let n,i=!1;t.forEach((e=>{let t=document.getElementById("tablinks_div");n=document.createElement("button"),n.classList.add("tablinks"),n.setAttribute("data-id",e.id),n.innerHTML=e.name,n.onclick=()=>{opentab(event,e.id)};document.getElementById("default");t.appendChild(n),i=!0;let o=document.getElementById("tabs"),l=document.createElement("div");l.classList.add("tabcontent"),l.id=e.id,o.appendChild(l),init_box_coll(l)})),e=!0}}))}))}function init_box_coll(e){var t=!1,n=location.host,i=io("http://"+n,{transports:["websocket"]});i.on("connect",(()=>{i.emit("sql_read","SELECT * FROM box WHERE box_group_id ='"+e.id+"' ORDER BY name ASC"),i.on("sql_rSELECT * FROM box WHERE box_group_id ='"+e.id+"' ORDER BY name ASC",(n=>{t||(n.forEach((t=>{let n=document.createElement("div");n.classList.add("row");let i=document.createElement("div");i.classList.add("col-lg-11"),n.appendChild(i);let o=document.createElement("p");o.classList.add("collapsible"),o.innerHTML=t.name,i.appendChild(o),null!=t.color?o.style.backgroundColor=t.color:o.style.backgroundColor="#FFFFFF",e.appendChild(n);let l=document.createElement("div");l.classList.add("col-lg-1"),l.style.transform="translateY(25%)";let a=document.createElement("a");a.href="http://"+location.host+"/box?id="+t.id,l.appendChild(a);let r=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttributeNS(null,"viewBox","0 0 528.899 528.899"),d.setAttributeNS(null,"d","M328.883,89.125l107.59,107.589l-272.34,272.34L56.604,361.465L328.883,89.125z M518.113,63.177l-47.981-47.981   c-18.543-18.543-48.653-18.543-67.259,0l-45.961,45.961l107.59,107.59l53.611-53.611   C532.495,100.753,532.495,77.559,518.113,63.177z M0.3,512.69c-1.958,8.812,5.998,16.708,14.811,14.565l119.891-29.069   L27.473,390.597L0.3,512.69z"),a.appendChild(r),r.style.width="2rem",r.style.height="2rem",r.appendChild(d),n.appendChild(l);let s=document.createElement("div");s.classList.add("content"),s.id=t.name,s.setAttribute("data-id",t.id),s.style.display="none",e.append(s),init_item_row(s,t),init_collapse(n)})),t=!0)}))}))}function init_item_row(e,t){var n=!1,i=location.host,o=io("http://"+i,{transports:["websocket"]});o.on("connect",(()=>{o.emit("sql_read","SELECT * FROM item_box ib LEFT JOIN item i ON ib.item_id = i.id WHERE ib.box_id='"+parseInt(e.getAttribute("data-id"))+"' ORDER BY i.name ASC"),o.on("sql_rSELECT * FROM item_box ib LEFT JOIN item i ON ib.item_id = i.id WHERE ib.box_id='"+parseInt(e.getAttribute("data-id"))+"' ORDER BY i.name ASC",(i=>{n||(i.forEach((n=>{let i=document.createElement("div");i.classList.add("row"),i.classList.add("item"),e.appendChild(i);let o=document.createElement("div");o.classList.add("col-lg-12"),o.id=t.name+"_"+n.name,i.appendChild(o);let l=document.createElement("a");l.id="link"+t.name+"_"+n.name,l.href="http://"+location.host+"/item?id="+n.id,l.style.color="black",l.style.textDecoration="none",o.appendChild(l),i=document.createElement("div"),i.classList.add("row"),i.style.marginTop="1rem",l.appendChild(i);let a=document.createElement("div");a.classList.add("col-lg-6"),i.appendChild(a);let r=document.createElement("p");r.innerHTML=n.name,a.appendChild(r),a=document.createElement("div"),a.classList.add("col-lg-6"),i.appendChild(a),r=document.createElement("p"),r.innerHTML=n.quantity,a.appendChild(r)})),n=!0)}))}))}urlp=[];if(-1!=location.toString().indexOf("?"))for(s=location.toString().split("?"),s=s[1].split("&"),i=0;i<s.length;i++)-1!=s[i].indexOf("=")?(u=s[i].split("="),urlp[u[0]]=u[1]):urlp[s[i]]="";var QRCode;url=document.URL,id=-1;function getid(){if((null!=parseInt(urlp.id)||""!=urlp.id)&&parseInt(urlp.id)>=0)return id=parseInt(urlp.id),init_f(id),id;if(""==urlp.name&&null==urlp.name&&""==urlp.n&&null==urlp.n)return nofile(),-1;var e=location.host,t=io("http://"+e,{transports:["websocket"]});t.once("connect",(()=>{let e=urlp.n||urlp.name;e="SELECT * FROM item WHERE name='"+e+"'",t.emit("sql_read",e),t.once("sql_r"+e,(e=>{e.forEach((e=>{if(e.name===urlp.n||e.name===urlp.name)return id=e.id,init_f(id),id}))}))}))}function init(){getid(),init_picture()}function init_f(e){if(e>=1){var t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{n.emit("getItem_data",e),n.once("getsize_Unit",(t=>{n.once("getweight_Unit",(i=>{n.once("item"+e,(o=>{console.log(o),0!=o.length?(o.forEach((o=>{document.getElementById("title").innerHTML=o.item_name,document.getElementById("item_id").innerHTML=e,document.getElementById("item_name").innerHTML=o.item_name,document.getElementById("total_quantity").innerHTML=o.total_quantity,document.getElementById("item_img").alt=o.item_name,document.getElementById("item_price").innerHTML=o.price;let l=parseFloat(o.size),a=[],r=[],d=[],s=[],c=!1;if(null!=t?t.forEach((e=>{a=[...a,""+l/parseFloat(e.multiplicator)],r=[...r,e],c=!0})):(n.emit("refresh",!0),n.once("reloaded",(e=>{n.once("getsize_Unit",(e=>{null!=e&&e.forEach((e=>{a=[...a,""+l/parseFloat(e.multiplicator)],r=[...r,e],c=!0}))}))}))),c){let e=0;for(let t=0;t<a.length;t++)a[e].length>a[t].length&&(e=t);document.getElementById("item_size").innerHTML=l/parseFloat(t[e].multiplicator),document.getElementById("item_size_unit").innerHTML=t[e].name}else console.log("Unit konnte nicht geladen werden."),document.getElementById("item_size").innerHTML=o.size,document.getElementById("item_size_unit").innerHTML="cm";if(l=parseFloat(o.weight),c=!1,null!=i?i.forEach((e=>{d=[...d,""+l/parseFloat(e.multiplicator)],s=[...s,e],c=!0})):(n.emit("refresh",!0),n.once("reloaded",(e=>{n.once("getweight_Unit",(e=>{null!=e&&e.forEach((e=>{d=[...d,""+l/parseFloat(e.multiplicator)],s=[...s,e],c=!0}))}))}))),c){let e=0;for(let t=0;t<d.length;t++)d[e].length>d[t].length&&(e=t);document.getElementById("item_weight").innerHTML=l/parseFloat(i[e].multiplicator),document.getElementById("item_weight_unit").innerHTML=i[e].name}else console.log("Unit konnte nicht geladen werden."),document.getElementById("item_weight").innerHTML=o.size,document.getElementById("item_weight_unit").innerHTML="g";console.log(o),null!=o.picture?(document.getElementById("item_img").src=o.picture,document.getElementById("item_picture").innerHTML=o.picture):document.getElementById("item_picture").innerHTML="undefined",null!=o.color&&(document.getElementById("color_row").style.backgroundColor=o.color,document.getElementById("item_color").innerHTML=o.color,"#ffffff"===o.color?document.getElementById("item_color").style.color="#000000":document.getElementById("item_color").style.color=o.color),n.emit("sql_read","SELECT * FROM instructions WHERE id ='"+parseInt(o.instructions_id)+"'"),n.once("sql_rSELECT * FROM instructions WHERE id ='"+parseInt(o.instructions_id)+"'",(e=>{e.forEach((e=>{document.getElementById("text").innerHTML=e.name,n.emit("getfile","/../user_data/_txt/"+e.document),n.once("get_f/../user_data/_txt/"+e.document,(t=>{document.getElementById("textarea").value=t,document.getElementById("textarea").setAttribute("data-path",e.document),document.getElementById("textarea").setAttribute("data-or",t),document.getElementById("textarea").style.display="block"}))}))}))})),init_tab_links(o)):(document.getElementById("body").style.display="none",document.getElementById("html").innerHTML="The item with the id: "+e+" doesn't exist")}))}))}))}))}}function nofile(){document.write("opps this doesn't exist - 404  -  (tipp: use /item?id=[item_id])")}function init_picture(){var e=document.getElementById("myModal"),t=document.getElementById("item_img"),n=document.getElementById("img01"),i=document.getElementById("caption");t.onclick=function(){e.style.display="block",n.src=this.src,i.innerHTML=this.alt},document.getElementsByClassName("close")[0].onclick=function(){e.style.display="none"}}function init_tab_links(e){let t,n,i=!1,o=[];e.forEach((e=>{if(o.includes(e.box_group_id))init_box_coll(n,e);else{o=[...o,parseInt(e.box_group_id)],null!=e.box_id?document.getElementById("setup").style.display="block":document.getElementById("setup").style.display="none";let l=document.getElementById("tablinks_div");t=document.createElement("button"),t.classList.add("tablinks"),t.setAttribute("data-id",e.box_group_id),t.innerHTML=e.bg_name,t.onclick=()=>{opentab(event,e.box_group_id)};document.getElementById("default");l.appendChild(t),i=!0;let a=document.getElementById("tabs");n=document.createElement("div"),n.classList.add("tabcontent"),n.id=e.box_group_id,a.appendChild(n),init_box_coll(n,e)}}))}function init_box_coll(e,t){let n=document.createElement("div");n.classList.add("row");let i=document.createElement("div");i.classList.add("col-lg-11"),n.appendChild(i);let o=document.createElement("p");o.classList.add("collapsible"),o.innerHTML=t.box_name,i.appendChild(o),null!=t.box_color?o.style.backgroundColor=t.box_color:o.style.backgroundColor="#FFFFFF",e.appendChild(n);let l=document.createElement("div");l.classList.add("col-lg-1"),l.style.transform="translateY(25%)";let a=document.createElement("a");a.href="http://"+location.host+"/box?id="+t.box_id,l.appendChild(a);let r=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttributeNS(null,"viewBox","0 0 528.899 528.899"),d.setAttributeNS(null,"d","M328.883,89.125l107.59,107.589l-272.34,272.34L56.604,361.465L328.883,89.125z M518.113,63.177l-47.981-47.981   c-18.543-18.543-48.653-18.543-67.259,0l-45.961,45.961l107.59,107.59l53.611-53.611   C532.495,100.753,532.495,77.559,518.113,63.177z M0.3,512.69c-1.958,8.812,5.998,16.708,14.811,14.565l119.891-29.069   L27.473,390.597L0.3,512.69z"),a.appendChild(r),r.style.width="2rem",r.style.height="2rem",r.appendChild(d),n.appendChild(l);let s=document.createElement("div");s.classList.add("content"),s.id=t.box_name,s.setAttribute("data-id",t.box_id),s.style.display="none",e.append(s),init_item_row(s,t),init_collapse(n)}function init_item_row(e,t){let n=document.createElement("div");n.classList.add("row"),e.appendChild(n);let i=document.createElement("div");i.classList.add("col-lg-12"),i.id=t.box_name+"_"+t.item_name,n.appendChild(i),n=document.createElement("div"),n.classList.add("row"),n.style.marginTop="1rem",i.appendChild(n);let o=document.createElement("div");o.classList.add("col-lg-6"),n.appendChild(o);let l=document.createElement("p");l.innerHTML=t.item_name,o.appendChild(l),o=document.createElement("div"),o.classList.add("col-lg-6"),n.appendChild(o),l=document.createElement("p"),l.innerHTML=t.quantity,o.appendChild(l)}function opentab(e,t){if(e.currentTarget.classList.contains("active"))e.currentTarget.className=e.currentTarget.className.replace(" active",""),document.getElementById(t).style.display="none",document.getElementById("edit_box").style.display="none",document.getElementById("edit_pen_box").href="";else{var n,i,o;for(i=document.getElementsByClassName("tabcontent"),n=0;n<i.length;n++)i[n].style.display="none";for(o=document.getElementsByClassName("tablinks"),n=0;n<o.length;n++)o[n].className=o[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active",document.getElementById("edit_box").style.display="block",document.getElementById("edit_pen_box").href="http://"+location.host+"/box_group?id="+e.currentTarget.getAttribute("data-id")}}function init_collapse(e){e.addEventListener("click",(function(){let e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"}))}function refresh(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{e||(n.emit("refresh",!0),n.once("reloaded",(t=>{e=!0,location.reload()})))}))}function change_item_name(e){if("true"===e){var t=document.getElementById("item_name_edit").value;if(document.getElementById("item_name").value=t,document.getElementById("item_name_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.once("connect",(()=>{i.emit("sql_read","SELECT * FROM item WHERE name='"+t+"'"),i.once("sql_rSELECT * FROM item WHERE name='"+t+"'",(e=>{if(e.length<=0){let e=[];e=["UPDATE item SET name ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.once("sql_i"+e,(e=>{location.reload()}))}else console.log("Name already exist")}))}))}else location.reload()}else{document.getElementById("edit_pen_name").disabled=!0,document.getElementById("edit_pen_name").style.display="none",document.getElementById("edit_save_name").style.display="block",document.getElementById("edit_save_name").disabled=!0;let e=document.createElement("input");e.type="text",e.id="item_name_edit",e.style.width="16rem",e.style.height="3rem",e.title="item name",e.placeholder="name",document.getElementById("item_name").style.display="none",document.getElementById("item_name").parentElement.appendChild(e),e.autofocus}}function change_item_price(e){if("true"===e){var t=document.getElementById("item_price_edit").value;if(document.getElementById("item_price").value=t,document.getElementById("item_price_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.once("connect",(()=>{let e=[];e=["UPDATE item SET price ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.once("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_price").disabled=!0,document.getElementById("edit_pen_price").style.display="none",document.getElementById("edit_save_price").style.display="block",document.getElementById("edit_save_price").disabled=!0;let e=document.createElement("input");e.type="number",e.id="item_price_edit",e.style.width="16rem",e.style.height="3rem",e.title="item price",e.placeholder="price",document.getElementById("item_price").style.display="none",document.getElementById("item_price").parentElement.appendChild(e),e.autofocus}}function change_item_weight(e){if("true"===e){var t=document.getElementById("item_weight_edit").value;document.getElementById("item_weight").value=t,document.getElementById("item_weight_edit").value=t;var n=document.getElementById("weight_unit").value;if(document.getElementById("weight_unit").value="g",""!=t){var i=location.host;(o=io("http://"+i,{transports:["websocket"]})).once("connect",(()=>{o.once("getweight_Unit",(e=>{e.forEach((e=>{if(n===e.name){t=~~(1e3*(t*=parseFloat(e.multiplicator))),t/=1e3;let n=[];console.log(t),n=["UPDATE item SET weight ='"+t+"' WHERE id = '"+id+"'",n],o.emit("sql_insert",n),o.once("sql_i"+n,(e=>{location.reload()}))}}))}))}))}else location.reload()}else{document.getElementById("edit_pen_weight").disabled=!0,document.getElementById("edit_pen_weight").style.display="none",document.getElementById("edit_save_weight").style.display="block",document.getElementById("edit_save_weight").disabled=!1;let e=document.createElement("input");e.type="number",e.id="item_weight_edit",e.style.width="16rem",e.style.height="3rem",e.title="item weight",e.placeholder="0",document.getElementById("item_weight").style.display="none",document.getElementById("item_weight").parentElement.appendChild(e);var o;i=location.host;(o=io("http://"+i,{transports:["websocket"]})).once("connect",(()=>{o.once("getweight_Unit",(e=>{let t=document.createElement("form");t.id="item_unit_edit";let n=document.createElement("label");n.htmlFor="weight_unit",t.appendChild(n);let i=document.createElement("select");i.id="weight_unit",i.name="weight unit",i.style.width="5rem",i.style.height="3rem",n.appendChild(i),e.forEach((e=>{let t=document.createElement("option");i.appendChild(t),t.value=e.name,t.innerHTML=e.name})),document.getElementById("item_weight_unit").style.display="none",document.getElementById("item_weight_unit").parentElement.appendChild(t)}))}))}}function change_item_quantity(e){if("true"===e){var t=document.getElementById("total_quantity_edit").value;if(document.getElementById("total_quantity_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.once("connect",(()=>{i.emit("getItem_data",id),i.once("item"+id,(e=>{e.forEach((e=>{if(e.total_quantity>t)i.emit("sql_read","SELECT * FROM item_box WHERE item_id ='"+id+"' AND box_id='1'"),i.once("sql_rSELECT * FROM item_box WHERE item_id ='"+id+"' AND box_id='1'",(n=>{if(n.length>1||n.length<0)console.log("Wrong data in the database");else if(n=n[0],console.log(n),0==n.quantity){let t=[];t=["UPDATE item SET total_quantity ='"+e.total_quantity+"' WHERE id = '"+id+"'",t],i.emit("sql_insert",t),i.once("sql_i"+t,(e=>{location.reload()}))}else if(n.quantity-(e.total_quantity-t)<0){let t=[];t=["UPDATE item SET total_quantity ='"+(e.total_quantity-n.quantity)+"' WHERE id = '"+id+"'",t],i.emit("sql_insert",t),i.once("sql_i"+t,(e=>{t=[],t=["UPDATE item_box SET quantity ='0' WHERE item_id = '"+id+"' AND box_id='1'",t],i.emit("sql_insert",t),i.once("sql_i"+t,(e=>{location.reload()}))}))}else{let o=[];o=["UPDATE item SET total_quantity ='"+t+"' WHERE id = '"+id+"'",o],i.emit("sql_insert",o),i.once("sql_i"+o,(l=>{o=[],o=["UPDATE item_box SET quantity ='"+(n.quantity-(e.total_quantity-t))+"' WHERE item_id = '"+id+"' AND box_id='1'",o],console.log(n.quantity-(e.total_quantity-t)+", "+n.quantity+", "+e.total_quantity+", "+t),console.log(o),i.emit("sql_insert",o),i.once("sql_i"+o,(e=>{}))}))}}));else if(e.total_quantity<t){let e=[];e=["UPDATE item SET total_quantity ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.once("sql_i"+e,(n=>{i.emit("sql_read","SELECT * FROM item_box WHERE item_id ='"+id+"' AND NOT box_id='1'"),i.once("sql_rSELECT * FROM item_box WHERE item_id ='"+id+"' AND NOT box_id='1'",(n=>{let o=t;n.forEach((e=>{o-=e.quantity})),o<0?console.log("An error occured"):(e=[],e=["UPDATE item_box SET quantity ='"+o+"' WHERE item_id = '"+id+"' AND box_id='1'",e],i.emit("sql_insert",e),i.once("sql_i"+e,(e=>{location.reload()})))}))}))}}))}))}))}else location.reload()}else{old_quatity=document.getElementById("total_quantity").value,document.getElementById("edit_pen_quantity").disabled=!0,document.getElementById("edit_pen_quantity").style.display="none",document.getElementById("edit_save_quantity").style.display="block",document.getElementById("edit_save_quantity").disabled=!1;let e=document.createElement("input");e.type="number",e.id="total_quantity_edit",e.style.width="16rem",e.style.height="3rem",e.title="total quantity",e.placeholder="0",document.getElementById("total_quantity").style.display="none",document.getElementById("total_quantity").parentElement.appendChild(e),e.autofocus}}function change_item_size(e){if("true"===e){var t=document.getElementById("item_size_edit").value;document.getElementById("item_size").value=t,document.getElementById("item_size_edit").value=t;var n=document.getElementById("size_unit").value;if(document.getElementById("size_unit").value="mm",""!=t){var i=location.host;(o=io("http://"+i,{transports:["websocket"]})).once("connect",(()=>{o.once("getsize_Unit",(e=>{e.forEach((e=>{if(n===e.name){t=~~(1e3*(t*=parseFloat(e.multiplicator)));let n=[];n=["UPDATE item SET size ='"+(t/=1e3)+"' WHERE id = '"+id+"'",n],o.emit("sql_insert",n),o.once("sql_i"+n,(e=>{location.reload()}))}}))}))}))}else location.reload()}else{document.getElementById("edit_pen_size").disabled=!0,document.getElementById("edit_pen_size").style.display="none",document.getElementById("edit_save_size").style.display="block",document.getElementById("edit_save_size").disabled=!1;let e=document.createElement("input");e.type="number",e.id="item_size_edit",e.style.width="16rem",e.style.height="3rem",e.title="item size",e.placeholder="0",document.getElementById("item_size").style.display="none",document.getElementById("item_size").parentElement.appendChild(e);var o;i=location.host;(o=io("http://"+i,{transports:["websocket"]})).once("connect",(()=>{o.once("getsize_Unit",(e=>{let t=document.createElement("form");t.id="item_unit_edit";let n=document.createElement("label");n.htmlFor="size_unit",t.appendChild(n);let i=document.createElement("select");i.id="size_unit",i.name="size unit",i.style.width="5rem",i.style.height="3rem",n.appendChild(i),e.forEach((e=>{let t=document.createElement("option");i.appendChild(t),t.value=e.name,t.innerHTML=e.name})),document.getElementById("item_size_unit").style.display="none",document.getElementById("item_size_unit").parentElement.appendChild(t)}))}))}}function change_item_inst(e){if("true"===e){var t=document.getElementById("textarea").value,n=document.getElementById("inst_edit_form").value,i=document.getElementById("inst_edit").value;if(t!=document.getElementById("textarea").getAttribute("data-or")){var o=location.host;(l=io("http://"+o,{transports:["websocket"]})).once("connect",(()=>{l.once("getdocuments",(e=>{let o=!1;for(let n=0;n<e;n+2){let i=[e[n],e[n+1]];if(i[0]==t){let e=[];e=["UPDATE item SET instructions_id ='"+i[1]+"' WHERE id = '"+id+"'",e],o=!0,a.emit("sql_insert",e),a.once("sql_i"+e,(e=>{location.reload()}))}}if(!o){var l=location.host,a=io("http://"+l,{transports:["websocket"]});if(""!=i){let e;e=[i,[id],t,t.length],o=!0,a.emit("instruction_data",e),a.once("successinst",(e=>{location.reload()}))}else if(n==document.getElementById("text").innerHTML){let e=[document.getElementById("textarea").getAttribute("data-path"),t];o=!0,a.emit("setfile",e),a.once("set_f"+e,(e=>{location.reload()}))}else{l=location.host;(a=io("http://"+l,{transports:["websocket"]})).once("connect",(()=>{a.emit("sql_read","SELECT * FROM instructions WHERE name ='"+n+"'"),a.once("sql_rSELECT * FROM instructions WHERE name ='"+n+"'",(e=>{e.forEach((e=>{let t=[];t=["UPDATE item SET instructions_id ='"+e.id+"' WHERE id = '"+id+"'",t],a.emit("sql_insert",t),a.once("sql_i"+t,(e=>{location.reload()}))}))}))}))}}}))}))}else if(""!=i){o=location.host;(l=io("http://"+o,{transports:["websocket"]})).once("connect",(()=>{l.emit("sql_read","SELECT * FROM instructions WHERE name ='"+n+"'"),l.once("sql_rSELECT * FROM instructions WHERE name ='"+n+"'",(e=>{e.forEach((e=>{let t=[];t=["UPDATE instructions SET name ='"+i+"' WHERE id = '"+e.id+"'",t],l.emit("sql_insert",t),l.once("sql_i"+t,(e=>{location.reload()}))}))}))}))}else if(n!=document.getElementById("text").innerHTML){o=location.host;(l=io("http://"+o,{transports:["websocket"]})).once("connect",(()=>{l.emit("sql_read","SELECT * FROM instructions WHERE name ='"+n+"'"),l.once("sql_rSELECT * FROM instructions WHERE name ='"+n+"'",(e=>{e.forEach((e=>{let t=[];t=["UPDATE item SET instructions_id ='"+e.id+"' WHERE id = '"+id+"'",t],l.emit("sql_insert",t),l.once("sql_i"+t,(e=>{location.reload()}))}))}))}))}else location.reload()}else{document.getElementById("edit_pen_inst").disabled=!0,document.getElementById("edit_pen_inst").style.display="none",document.getElementById("edit_save_inst").style.display="block",document.getElementById("edit_save_inst").disabled=!1,document.getElementById("textarea").style.display="block",document.getElementById("textarea").readOnly=!1;var l;o=location.host;(l=io("http://"+o,{transports:["websocket"]})).once("connect",(()=>{l.once("getinstructions",(e=>{let t=document.createElement("form");t.id="item_inst_edit";let n=document.createElement("label");n.htmlFor="inst",t.appendChild(n);let i=document.createElement("select");i.id="inst_edit_form",i.name="inst_edit",i.style.width="5rem",i.style.height="3rem",i.onchange=()=>{txtchange()},n.appendChild(i),document.getElementById("text").style.display="none",document.getElementById("text").parentElement.appendChild(t),e.forEach((e=>{let t=document.createElement("option");i.appendChild(t),t.value=e.name,t.id=e.id,t.innerHTML=e.name}));let o=document.createElement("input");o.type="text",o.id="inst_edit",o.style.width="16rem",o.style.height="3rem",o.title="instruction name",o.placeholder="name",document.getElementById("text").parentElement.appendChild(o),i.value=document.getElementById("text").innerHTML}))}))}}function txtchange(){let e=document.getElementById("inst_edit_form");var t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{n.emit("sql_read","SELECT * FROM instructions WHERE name ='"+e.value+"'"),n.once("sql_rSELECT * FROM instructions WHERE name ='"+e.value+"'",(e=>{e.forEach((e=>{n.emit("getfile","/../user_data/_txt/"+e.document),n.once("get_f/../user_data/_txt/"+e.document,(t=>{document.getElementById("textarea").value=t,document.getElementById("textarea").setAttribute("data-path",e.document),document.getElementById("textarea").setAttribute("data-or",t),document.getElementById("textarea").style.display="block"}))}))}))}))}function change_item_color(e){if("true"===e){var t=document.getElementById("item_color_edit").value;if(document.getElementById("item_color_edit").value=t,""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.once("connect",(()=>{let e=[];e=["UPDATE item SET color ='"+t+"' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.once("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_color").disabled=!0,document.getElementById("edit_pen_color").style.display="none",document.getElementById("edit_save_color").style.display="block",document.getElementById("edit_save_color").disabled=!0;let e=document.createElement("input");e.type="color",e.id="item_color_edit",e.style.width="16rem",e.style.height="3rem",e.title="item color",e.placeholder="color",e.value=document.getElementById("item_color").innerHTML,document.getElementById("item_color").style.display="none",document.getElementById("item_color").parentElement.appendChild(e),e.autofocus}}function change_item_picture(e){if("true"===e){var t=document.getElementById("item_pic_edit").files;if(""!=t){var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.once("connect",(()=>{let e=[];console.log(["item?id="+id+".jpg",t[0]]),i.emit("setpicture",["item?id="+id+".jpg",t[0]]),e=["UPDATE item SET picture ='item?id="+id+".jpg' WHERE id = '"+id+"'",e],i.emit("sql_insert",e),i.once("sql_i"+e,(e=>{location.reload()}))}))}else location.reload()}else{document.getElementById("edit_pen_picture").disabled=!0,document.getElementById("edit_pen_picture").style.display="none",document.getElementById("edit_save_picture").style.display="block",document.getElementById("edit_save_picture").disabled=!0;let e=document.createElement("input");e.type="file",e.accept=".jpg",e.id="item_pic_edit",e.style.width="16rem",e.style.height="3rem",e.title="item pic",e.placeholder="item",document.getElementById("item_picture").style.display="none",document.getElementById("item_picture").parentElement.appendChild(e)}}function del(){var e=location.host,t=io("http://"+e,{transports:["websocket"]});t.once("connect",(()=>{t.emit("getItem_data",id),t.once("item"+id,(e=>{let n=prompt("Please Confirm to continue deleting the following object: Item "+id+", name "+e.name+", by typing the id");null!=n&&parseInt(n)===id?(t.emit("sql_delete","DELETE FROM item WHERE item.id="+id+";"),t.once("sql_dDELETE FROM item WHERE item.id="+id+";",(e=>{e&&(location.href="/index")}))):location.reload()}))}))}document.querySelectorAll("[data-bss-baguettebox]").length>0&&baguetteBox.run("[data-bss-baguettebox]",{animation:"slideIn"});"use strict";function nav_items(){var e=!1,t=location.host,n=io("http://"+t,{transports:["websocket"]});n.once("connect",(()=>{n.once("html",(t=>{if(null!=t)e||(t.forEach((function(e){var t=document.createElement("li");t.classList.add("nav-item");let n=document.createElement("a");n.classList.add("nav-link"),n.href=e.path,n.id=e.name,n.innerText=e.name,t.appendChild(n),document.getElementById("nav_ul").appendChild(t)})),e=!0);else{var n=location.host,i=io("http://"+n,{transports:["websocket"]});i.once("connect",(()=>{i.once("html",(e=>{null!=e?(console.log(e),nav_items()):(console.log("reload not successfull"),location.reload)}))}))}}))}))}!function(){function e(e){this.mode=n.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,i=this.data.length;t<i;t++){var o=[],l=this.data.charCodeAt(t);l>65536?(o[0]=240|(1835008&l)>>>18,o[1]=128|(258048&l)>>>12,o[2]=128|(4032&l)>>>6,o[3]=128|63&l):l>2048?(o[0]=224|(61440&l)>>>12,o[1]=128|(4032&l)>>>6,o[2]=128|63&l):l>128?(o[0]=192|(1984&l)>>>6,o[1]=128|63&l):o[0]=l,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;t<n;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[i][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var i=-1;i<=7;i++)t+i<=-1||this.moduleCount<=t+i||(this.modules[e+n][t+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;n<8;n++){this.makeImpl(!0,n);var i=u.getLostPoint(this);(0==n||e>i)&&(e=i,t=n)}return t},createMovieClip:function(e,t,n){var i=e.createEmptyMovieClip(t,n);this.make();for(var o=0;o<this.modules.length;o++)for(var l=1*o,a=0;a<this.modules[o].length;a++){var r=1*a;this.modules[o][a]&&(i.beginFill(0,100),i.moveTo(r,l),i.lineTo(r+1,l),i.lineTo(r+1,l+1),i.lineTo(r,l+1),i.endFill())}return i},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=u.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var i=e[t],o=e[n];if(null==this.modules[i][o])for(var l=-2;l<=2;l++)for(var a=-2;a<=2;a++)this.modules[i+l][o+a]=-2==l||2==l||-2==a||2==a||0==l&&0==a}},setupTypeNumber:function(e){for(var t=u.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;n<18;n++){i=!e&&1==(t>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,i=u.getBCHTypeInfo(n),o=0;o<15;o++){var l=!e&&1==(i>>o&1);o<6?this.modules[o][8]=l:o<8?this.modules[o+1][8]=l:this.modules[this.moduleCount-15+o][8]=l}for(o=0;o<15;o++){l=!e&&1==(i>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=l:o<9?this.modules[8][15-o-1+1]=l:this.modules[8][15-o-1]=l}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,i=this.moduleCount-1,o=7,l=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var r=0;r<2;r++)if(null==this.modules[i][a-r]){var d=!1;l<e.length&&(d=1==(e[l]>>>o&1)),u.getMask(t,i,a-r)&&(d=!d),this.modules[i][a-r]=d,-1==--o&&(l++,o=7)}if((i+=n)<0||this.moduleCount<=i){i-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,i){for(var o=g.getRSBlocks(e,n),l=new _,a=0;a<i.length;a++){var r=i[a];l.put(r.mode,4),l.put(r.getLength(),u.getLengthInBits(r.mode,e)),r.write(l)}var d=0;for(a=0;a<o.length;a++)d+=o[a].dataCount;if(l.getLengthInBits()>8*d)throw new Error("code length overflow. ("+l.getLengthInBits()+">"+8*d+")");for(l.getLengthInBits()+4<=8*d&&l.put(0,4);l.getLengthInBits()%8!=0;)l.putBit(!1);for(;!(l.getLengthInBits()>=8*d||(l.put(t.PAD0,8),l.getLengthInBits()>=8*d));)l.put(t.PAD1,8);return t.createBytes(l,o)},t.createBytes=function(e,t){for(var n=0,i=0,o=0,l=new Array(t.length),a=new Array(t.length),r=0;r<t.length;r++){var d=t[r].dataCount,s=t[r].totalCount-d;i=Math.max(i,d),o=Math.max(o,s),l[r]=new Array(d);for(var c=0;c<l[r].length;c++)l[r][c]=255&e.buffer[c+n];n+=d;var m=u.getErrorCorrectPolynomial(s),p=new E(l[r],m.getLength()-1).mod(m);a[r]=new Array(m.getLength()-1);for(c=0;c<a[r].length;c++){var h=c+p.getLength()-a[r].length;a[r][c]=h>=0?p.get(h):0}}var g=0;for(c=0;c<t.length;c++)g+=t[c].totalCount;var _=new Array(g),f=0;for(c=0;c<i;c++)for(r=0;r<t.length;r++)c<l[r].length&&(_[f++]=l[r][c]);for(c=0;c<o;c++)for(r=0;r<t.length;r++)c<a[r].length&&(_[f++]=a[r][c]);return _};for(var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},o=0,l=1,a=2,r=3,d=4,s=5,c=6,m=7,u={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;u.getBCHDigit(t)-u.getBCHDigit(u.G15)>=0;)t^=u.G15<<u.getBCHDigit(t)-u.getBCHDigit(u.G15);return(e<<10|t)^u.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;u.getBCHDigit(t)-u.getBCHDigit(u.G18)>=0;)t^=u.G18<<u.getBCHDigit(t)-u.getBCHDigit(u.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return u.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case o:return(t+n)%2==0;case l:return t%2==0;case a:return n%3==0;case r:return(t+n)%3==0;case d:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case s:return t*n%2+t*n%3==0;case c:return(t*n%2+t*n%3)%2==0;case m:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new E([1],0),n=0;n<e;n++)t=t.multiply(new E([1,p.gexp(n)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:case n.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,i=0;i<t;i++)for(var o=0;o<t;o++){for(var l=0,a=e.isDark(i,o),r=-1;r<=1;r++)if(!(i+r<0||t<=i+r))for(var d=-1;d<=1;d++)o+d<0||t<=o+d||0==r&&0==d||a==e.isDark(i+r,o+d)&&l++;l>5&&(n+=3+l-5)}for(i=0;i<t-1;i++)for(o=0;o<t-1;o++){var s=0;e.isDark(i,o)&&s++,e.isDark(i+1,o)&&s++,e.isDark(i,o+1)&&s++,e.isDark(i+1,o+1)&&s++,0!=s&&4!=s||(n+=3)}for(i=0;i<t;i++)for(o=0;o<t-6;o++)e.isDark(i,o)&&!e.isDark(i,o+1)&&e.isDark(i,o+2)&&e.isDark(i,o+3)&&e.isDark(i,o+4)&&!e.isDark(i,o+5)&&e.isDark(i,o+6)&&(n+=40);for(o=0;o<t;o++)for(i=0;i<t-6;i++)e.isDark(i,o)&&!e.isDark(i+1,o)&&e.isDark(i+2,o)&&e.isDark(i+3,o)&&e.isDark(i+4,o)&&!e.isDark(i+5,o)&&e.isDark(i+6,o)&&(n+=40);var c=0;for(o=0;o<t;o++)for(i=0;i<t;i++)e.isDark(i,o)&&c++;return n+=10*(Math.abs(100*c/t/t-50)/5)}},p={glog:function(e){if(e<1)throw new Error("glog("+e+")");return p.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return p.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},h=0;h<8;h++)p.EXP_TABLE[h]=1<<h;for(h=8;h<256;h++)p.EXP_TABLE[h]=p.EXP_TABLE[h-4]^p.EXP_TABLE[h-5]^p.EXP_TABLE[h-6]^p.EXP_TABLE[h-8];for(h=0;h<255;h++)p.LOG_TABLE[p.EXP_TABLE[h]]=h;function E(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var i=0;i<e.length-n;i++)this.num[i]=e[i+n]}function g(e,t){this.totalCount=e,this.dataCount=t}function _(){this.buffer=[],this.length=0}E.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<e.getLength();i++)t[n+i]^=p.gexp(p.glog(this.get(n))+p.glog(e.get(i)));return new E(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=p.glog(this.get(0))-p.glog(e.get(0)),n=new Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(i=0;i<e.getLength();i++)n[i]^=p.gexp(p.glog(e.get(i))+t);return new E(n,0).mod(e)}},g.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],g.getRSBlocks=function(e,t){var n=g.getRsBlockTable(e,t);if(null==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var i=n.length/3,o=[],l=0;l<i;l++)for(var a=n[3*l+0],r=n[3*l+1],d=n[3*l+2],s=0;s<a;s++)o.push(new g(r,d));return o},g.getRsBlockTable=function(e,t){switch(t){case i.L:return g.RS_BLOCK_TABLE[4*(e-1)+0];case i.M:return g.RS_BLOCK_TABLE[4*(e-1)+1];case i.Q:return g.RS_BLOCK_TABLE[4*(e-1)+2];case i.H:return g.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},_.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var f=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function b(){var e=!1,t=navigator.userAgent;if(/android/i.test(t)){e=!0;var n=t.toString().match(/android ([0-9]\.[0-9])/i);n&&n[1]&&(e=parseFloat(n[1]))}return e}var y=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){var t=this._htOption,n=this._el,i=e.getModuleCount();Math.floor(t.width/i),Math.floor(t.height/i);function o(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i]);return n}this.clear();var l=o("svg",{viewBox:"0 0 "+String(i)+" "+String(i),width:"100%",height:"100%",fill:t.colorLight});l.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.appendChild(l),l.appendChild(o("rect",{fill:t.colorLight,width:"100%",height:"100%"})),l.appendChild(o("rect",{fill:t.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;a<i;a++)for(var r=0;r<i;r++)if(e.isDark(a,r)){var d=o("use",{x:String(r),y:String(a)});d.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),l.appendChild(d)}},e.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},e}(),I="svg"===document.documentElement.tagName.toLowerCase()?y:"undefined"==typeof CanvasRenderingContext2D?function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){for(var t=this._htOption,n=this._el,i=e.getModuleCount(),o=Math.floor(t.width/i),l=Math.floor(t.height/i),a=['<table style="border:0;border-collapse:collapse;">'],r=0;r<i;r++){a.push("<tr>");for(var d=0;d<i;d++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+o+"px;height:"+l+"px;background-color:"+(e.isDark(r,d)?t.colorDark:t.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),n.innerHTML=a.join("");var s=n.childNodes[0],c=(t.width-s.offsetWidth)/2,m=(t.height-s.offsetHeight)/2;c>0&&m>0&&(s.style.margin=m+"px "+c+"px")},e.prototype.clear=function(){this._el.innerHTML=""},e}():function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}if(this._android&&this._android<=2.1){var t=1/window.devicePixelRatio,n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,i,o,l,a,r,d,s,c){if("nodeName"in e&&/img/i.test(e.nodeName))for(var m=arguments.length-1;m>=1;m--)arguments[m]=arguments[m]*t;else void 0===s&&(arguments[1]*=t,arguments[2]*=t,arguments[3]*=t,arguments[4]*=t);n.apply(this,arguments)}}function i(e,t){var n=this;if(n._fFail=t,n._fSuccess=e,null===n._bSupportDataURI){var i=document.createElement("img"),o=function(){n._bSupportDataURI=!1,n._fFail&&n._fFail.call(n)};return i.onabort=o,i.onerror=o,i.onload=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)},void(i.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===n._bSupportDataURI&&n._fSuccess?n._fSuccess.call(n):!1===n._bSupportDataURI&&n._fFail&&n._fFail.call(n)}var o=function(e,t){this._bIsPainted=!1,this._android=b(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return o.prototype.draw=function(e){var t=this._elImage,n=this._oContext,i=this._htOption,o=e.getModuleCount(),l=i.width/o,a=i.height/o,r=Math.round(l),d=Math.round(a);t.style.display="none",this.clear();for(var s=0;s<o;s++)for(var c=0;c<o;c++){var m=e.isDark(s,c),u=c*l,p=s*a;n.strokeStyle=m?i.colorDark:i.colorLight,n.lineWidth=1,n.fillStyle=m?i.colorDark:i.colorLight,n.fillRect(u,p,l,a),n.strokeRect(Math.floor(u)+.5,Math.floor(p)+.5,r,d),n.strokeRect(Math.ceil(u)-.5,Math.ceil(p)-.5,r,d)}this._bIsPainted=!0},o.prototype.makeImage=function(){this._bIsPainted&&i.call(this,e)},o.prototype.isPainted=function(){return this._bIsPainted},o.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},o.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},o}();function T(e,t){for(var n=1,o=function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}(e),l=0,a=f.length;l<=a;l++){var r=0;switch(t){case i.L:r=f[l][0];break;case i.M:r=f[l][1];break;case i.Q:r=f[l][2];break;case i.H:r=f[l][3]}if(o<=r)break;n++}if(n>f.length)throw new Error("Too long data");return n}QRCode=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:i.H},"string"==typeof t&&(t={text:t}),t)for(var n in t)this._htOption[n]=t[n];"string"==typeof e&&(e=document.getElementById(e)),this._htOption.useSVG&&(I=y),this._android=b(),this._el=e,this._oQRCode=null,this._oDrawing=new I(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(T(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=i}(),function(){function e(e){this.mode=r.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=[],n=0,i=this.data.length;i>n;n++){var o=this.data.charCodeAt(n);o>65536?(t[0]=240|(1835008&o)>>>18,t[1]=128|(258048&o)>>>12,t[2]=128|(4032&o)>>>6,t[3]=128|63&o):o>2048?(t[0]=224|(61440&o)>>>12,t[1]=128|(4032&o)>>>6,t[2]=128|63&o):o>128?(t[0]=192|(1984&o)>>>6,t[1]=128|63&o):t[0]=o,this.parsedData=this.parsedData.concat(t)}this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var i=0;i<e.length-n;i++)this.num[i]=e[i+n]}function i(e,t){this.totalCount=e,this.dataCount=t}function o(){this.buffer=[],this.length=0}function l(){var e=!1,t=navigator.userAgent;return/android/i.test(t)&&(e=!0,aMat=t.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(e=parseFloat(aMat[1]))),e}function a(e,t){for(var n=1,i=function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}(e),o=0,l=p.length;l>=o;o++){var a=0;switch(t){case d.L:a=p[o][0];break;case d.M:a=p[o][1];break;case d.Q:a=p[o][2];break;case d.H:a=p[o][3]}if(a>=i)break;n++}if(n>p.length)throw new Error("Too long data");return n}e.prototype={getLength:function(){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;n>t;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(0>e||this.moduleCount<=e||0>t||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[i][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;7>=n;n++)if(!(-1>=e+n||this.moduleCount<=e+n))for(var i=-1;7>=i;i++)-1>=t+i||this.moduleCount<=t+i||(this.modules[e+n][t+i]=n>=0&&6>=n&&(0==i||6==i)||i>=0&&6>=i&&(0==n||6==n)||n>=2&&4>=n&&i>=2&&4>=i)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;8>n;n++){this.makeImpl(!0,n);var i=c.getLostPoint(this);(0==n||e>i)&&(e=i,t=n)}return t},createMovieClip:function(e,t,n){var i=e.createEmptyMovieClip(t,n);this.make();for(var o=0;o<this.modules.length;o++)for(var l=1*o,a=0;a<this.modules[o].length;a++){var r=1*a;this.modules[o][a]&&(i.beginFill(0,100),i.moveTo(r,l),i.lineTo(r+1,l),i.lineTo(r+1,l+1),i.lineTo(r,l+1),i.endFill())}return i},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=0==e%2);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var e=c.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var i=e[t],o=e[n];if(null==this.modules[i][o])for(var l=-2;2>=l;l++)for(var a=-2;2>=a;a++)this.modules[i+l][o+a]=-2==l||2==l||-2==a||2==a||0==l&&0==a}},setupTypeNumber:function(e){for(var t=c.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var i=!e&&1==(1&t>>n);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;18>n;n++){i=!e&&1==(1&t>>n);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,i=c.getBCHTypeInfo(n),o=0;15>o;o++){var l=!e&&1==(1&i>>o);6>o?this.modules[o][8]=l:8>o?this.modules[o+1][8]=l:this.modules[this.moduleCount-15+o][8]=l}for(o=0;15>o;o++){l=!e&&1==(1&i>>o);8>o?this.modules[8][this.moduleCount-o-1]=l:9>o?this.modules[8][15-o-1+1]=l:this.modules[8][15-o-1]=l}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,i=this.moduleCount-1,o=7,l=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var r=0;2>r;r++)if(null==this.modules[i][a-r]){var d=!1;l<e.length&&(d=1==(1&e[l]>>>o)),c.getMask(t,i,a-r)&&(d=!d),this.modules[i][a-r]=d,-1==--o&&(l++,o=7)}if(0>(i+=n)||this.moduleCount<=i){i-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,l){for(var a=i.getRSBlocks(e,n),r=new o,d=0;d<l.length;d++){var s=l[d];r.put(s.mode,4),r.put(s.getLength(),c.getLengthInBits(s.mode,e)),s.write(r)}var m=0;for(d=0;d<a.length;d++)m+=a[d].dataCount;if(r.getLengthInBits()>8*m)throw new Error("code length overflow. ("+r.getLengthInBits()+">"+8*m+")");for(r.getLengthInBits()+4<=8*m&&r.put(0,4);0!=r.getLengthInBits()%8;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*m)&&(r.put(t.PAD0,8),!(r.getLengthInBits()>=8*m));)r.put(t.PAD1,8);return t.createBytes(r,a)},t.createBytes=function(e,t){for(var i=0,o=0,l=0,a=new Array(t.length),r=new Array(t.length),d=0;d<t.length;d++){var s=t[d].dataCount,m=t[d].totalCount-s;o=Math.max(o,s),l=Math.max(l,m),a[d]=new Array(s);for(var u=0;u<a[d].length;u++)a[d][u]=255&e.buffer[u+i];i+=s;var p=c.getErrorCorrectPolynomial(m),h=new n(a[d],p.getLength()-1).mod(p);r[d]=new Array(p.getLength()-1);for(u=0;u<r[d].length;u++){var E=u+h.getLength()-r[d].length;r[d][u]=E>=0?h.get(E):0}}var g=0;for(u=0;u<t.length;u++)g+=t[u].totalCount;var _=new Array(g),f=0;for(u=0;o>u;u++)for(d=0;d<t.length;d++)u<a[d].length&&(_[f++]=a[d][u]);for(u=0;l>u;u++)for(d=0;d<t.length;d++)u<r[d].length&&(_[f++]=r[d][u]);return _};for(var r={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},d={L:1,M:0,Q:3,H:2},s={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},c={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;c.getBCHDigit(t)-c.getBCHDigit(c.G15)>=0;)t^=c.G15<<c.getBCHDigit(t)-c.getBCHDigit(c.G15);return(e<<10|t)^c.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;c.getBCHDigit(t)-c.getBCHDigit(c.G18)>=0;)t^=c.G18<<c.getBCHDigit(t)-c.getBCHDigit(c.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return c.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case s.PATTERN000:return 0==(t+n)%2;case s.PATTERN001:return 0==t%2;case s.PATTERN010:return 0==n%3;case s.PATTERN011:return 0==(t+n)%3;case s.PATTERN100:return 0==(Math.floor(t/2)+Math.floor(n/3))%2;case s.PATTERN101:return 0==t*n%2+t*n%3;case s.PATTERN110:return 0==(t*n%2+t*n%3)%2;case s.PATTERN111:return 0==(t*n%3+(t+n)%2)%2;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new n([1],0),i=0;e>i;i++)t=t.multiply(new n([1,m.gexp(i)],0));return t},getLengthInBits:function(e,t){if(t>=1&&10>t)switch(e){case r.MODE_NUMBER:return 10;case r.MODE_ALPHA_NUM:return 9;case r.MODE_8BIT_BYTE:case r.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>t)switch(e){case r.MODE_NUMBER:return 12;case r.MODE_ALPHA_NUM:return 11;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>t))throw new Error("type:"+t);switch(e){case r.MODE_NUMBER:return 14;case r.MODE_ALPHA_NUM:return 13;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,i=0;t>i;i++)for(var o=0;t>o;o++){for(var l=0,a=e.isDark(i,o),r=-1;1>=r;r++)if(!(0>i+r||i+r>=t))for(var d=-1;1>=d;d++)0>o+d||o+d>=t||(0!=r||0!=d)&&a==e.isDark(i+r,o+d)&&l++;l>5&&(n+=3+l-5)}for(i=0;t-1>i;i++)for(o=0;t-1>o;o++){var s=0;e.isDark(i,o)&&s++,e.isDark(i+1,o)&&s++,e.isDark(i,o+1)&&s++,e.isDark(i+1,o+1)&&s++,(0==s||4==s)&&(n+=3)}for(i=0;t>i;i++)for(o=0;t-6>o;o++)e.isDark(i,o)&&!e.isDark(i,o+1)&&e.isDark(i,o+2)&&e.isDark(i,o+3)&&e.isDark(i,o+4)&&!e.isDark(i,o+5)&&e.isDark(i,o+6)&&(n+=40);for(o=0;t>o;o++)for(i=0;t-6>i;i++)e.isDark(i,o)&&!e.isDark(i+1,o)&&e.isDark(i+2,o)&&e.isDark(i+3,o)&&e.isDark(i+4,o)&&!e.isDark(i+5,o)&&e.isDark(i+6,o)&&(n+=40);var c=0;for(o=0;t>o;o++)for(i=0;t>i;i++)e.isDark(i,o)&&c++;return n+10*(Math.abs(100*c/t/t-50)/5)}},m={glog:function(e){if(1>e)throw new Error("glog("+e+")");return m.LOG_TABLE[e]},gexp:function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return m.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},u=0;8>u;u++)m.EXP_TABLE[u]=1<<u;for(u=8;256>u;u++)m.EXP_TABLE[u]=m.EXP_TABLE[u-4]^m.EXP_TABLE[u-5]^m.EXP_TABLE[u-6]^m.EXP_TABLE[u-8];for(u=0;255>u;u++)m.LOG_TABLE[m.EXP_TABLE[u]]=u;n.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),i=0;i<this.getLength();i++)for(var o=0;o<e.getLength();o++)t[i+o]^=m.gexp(m.glog(this.get(i))+m.glog(e.get(o)));return new n(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=m.glog(this.get(0))-m.glog(e.get(0)),i=new Array(this.getLength()),o=0;o<this.getLength();o++)i[o]=this.get(o);for(o=0;o<e.getLength();o++)i[o]^=m.gexp(m.glog(e.get(o))+t);return new n(i,0).mod(e)}},i.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],i.getRSBlocks=function(e,t){var n=i.getRsBlockTable(e,t);if(null==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var o=n.length/3,l=[],a=0;o>a;a++)for(var r=n[3*a+0],d=n[3*a+1],s=n[3*a+2],c=0;r>c;c++)l.push(new i(d,s));return l},i.getRsBlockTable=function(e,t){switch(t){case d.L:return i.RS_BLOCK_TABLE[4*(e-1)+0];case d.M:return i.RS_BLOCK_TABLE[4*(e-1)+1];case d.Q:return i.RS_BLOCK_TABLE[4*(e-1)+2];case d.H:return i.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},o.prototype={get:function(e){var t=Math.floor(e/8);return 1==(1&this.buffer[t]>>>7-e%8)},put:function(e,t){for(var n=0;t>n;n++)this.putBit(1==(1&e>>>t-n-1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],h=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){function t(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i]);return n}var n=this._htOption,i=this._el,o=e.getModuleCount();Math.floor(n.width/o),Math.floor(n.height/o),this.clear();var l=t("svg",{viewBox:"0 0 "+String(o)+" "+String(o),width:"100%",height:"100%",fill:n.colorLight});l.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),i.appendChild(l),l.appendChild(t("rect",{fill:n.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;o>a;a++)for(var r=0;o>r;r++)if(e.isDark(a,r)){var d=t("use",{x:String(a),y:String(r)});d.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),l.appendChild(d)}},e.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},e}(),E="svg"===document.documentElement.tagName.toLowerCase()?h:"undefined"!=typeof CanvasRenderingContext2D?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function t(e,t){var n=this;if(n._fFail=t,n._fSuccess=e,null===n._bSupportDataURI){var i=document.createElement("img"),o=function(){n._bSupportDataURI=!1,n._fFail&&_fFail.call(n)};return i.onabort=o,i.onerror=o,i.onload=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)},void(i.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===n._bSupportDataURI&&n._fSuccess?n._fSuccess.call(n):!1===n._bSupportDataURI&&n._fFail&&n._fFail.call(n)}if(this._android&&this._android<=2.1){var n=1/window.devicePixelRatio,i=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,t,o,l,a,r,d,s){if("nodeName"in e&&/img/i.test(e.nodeName))for(var c=arguments.length-1;c>=1;c--)arguments[c]=arguments[c]*n;else void 0===s&&(arguments[1]*=n,arguments[2]*=n,arguments[3]*=n,arguments[4]*=n);i.apply(this,arguments)}}var o=function(e,t){this._bIsPainted=!1,this._android=l(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return o.prototype.draw=function(e){var t=this._elImage,n=this._oContext,i=this._htOption,o=e.getModuleCount(),l=i.width/o,a=i.height/o,r=Math.round(l),d=Math.round(a);t.style.display="none",this.clear();for(var s=0;o>s;s++)for(var c=0;o>c;c++){var m=e.isDark(s,c),u=c*l,p=s*a;n.strokeStyle=m?i.colorDark:i.colorLight,n.lineWidth=1,n.fillStyle=m?i.colorDark:i.colorLight,n.fillRect(u,p,l,a),n.strokeRect(Math.floor(u)+.5,Math.floor(p)+.5,r,d),n.strokeRect(Math.ceil(u)-.5,Math.ceil(p)-.5,r,d)}this._bIsPainted=!0},o.prototype.makeImage=function(){this._bIsPainted&&t.call(this,e)},o.prototype.isPainted=function(){return this._bIsPainted},o.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},o.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},o}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){for(var t=this._htOption,n=this._el,i=e.getModuleCount(),o=Math.floor(t.width/i),l=Math.floor(t.height/i),a=['<table style="border:0;border-collapse:collapse;">'],r=0;i>r;r++){a.push("<tr>");for(var d=0;i>d;d++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+o+"px;height:"+l+"px;background-color:"+(e.isDark(r,d)?t.colorDark:t.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),n.innerHTML=a.join("");var s=n.childNodes[0],c=(t.width-s.offsetWidth)/2,m=(t.height-s.offsetHeight)/2;c>0&&m>0&&(s.style.margin=m+"px "+c+"px")},e.prototype.clear=function(){this._el.innerHTML=""},e}();QRCode=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:d.H},"string"==typeof t&&(t={text:t}),t)for(var n in t)this._htOption[n]=t[n];"string"==typeof e&&(e=document.getElementById(e)),this._android=l(),this._el=e,this._oQRCode=null,this._oDrawing=new E(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(a(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=d}();var ip,pages=["index","inventory_setup","add_objects","settings"],size_unitlist=["mm",.1,"cm",1,"dm",10,"m",100,"km",1e3],weight_unitlist=["g",.001,"kg",1,"t",1e3],ip_connections=[],user=[],sql=require("./sql")(),fs=require("fs"),idu=require("image-data-uri");if("0.0.0.0"!=(file=preparefile(__dirname+"\\..\\settings.txt"))[1])ip=file[1];else{var _=require("underscore");ip=_.chain(require("os").networkInterfaces()).values().flatten().filter((function(e){return"IPv4"==e.family&&0==e.internal})).pluck("address").first().value()}var http=require("http"),server_port1=process.env.PORT||file[2],server_port2=process.env.PORT||file[5];url=require("url");function preparefile(e){console.log(e);let t=fs.readFileSync(e,"utf-8").toString().split(/\r?\n/),n=[];if(null!=t)return t.forEach((function(e){if(-1!=e.indexOf("#")){let t=e.substring(1);n=[...n,t]}})),n;console.log("Settings file has to be created manually")}function remove(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}function fserverhandler(e,t){var n=url.parse(e.url).pathname;if(""!=n){let e=n.split("");e=e.slice(1,n.length),n=e.join("")}""!=n&&"html"!=n||(n=pages[0]+".html"),pages.includes(n)&&(n+=".html");var i=!1;if(-1!=n.indexOf(".html")&&!i)if(i=!0,pages.includes(n.substring(0,n.length-5))||pages.includes(n)){let i=!1;for(var o=0;o<pages.length;o++){let l=pages[o];l!=n&&l+".html"!=n||i||openprompt(l,t,e)&&(i=!0,t.writeHead(200,{"Content-Type":"text/html"}),fs.readFile(__dirname+"/../html/"+l+".html",(function(e,n){if(e)throw t.writeHead(404),t.end(),e;t.write(n),t.end()})))}}else i=!0,t.write("opps this doesn't exist - 404"),t.writeHead(404),t.end();-1==n.indexOf(".ico")||i||(i=!0,"favicon.ico"==n&&(t.writeHead(200,{"Content-Type":"image/icon"}),fs.readFile(__dirname+"/../favicon.ico",(function(e,n){if(e)throw t.writeHead(404),t.end(),e;t.write(n),t.end()})))),-1==n.indexOf("png")&&-1==n.indexOf("jpg")||i||(i=!0,t.writeHead(200,{"Content-Type":"image"}),fs.readFile(file[0]+"/_"+n,(function(e,n){if(e)throw t.writeHead(404),t.end(),e;t.write(n),t.end()}))),-1==n.indexOf(".txt")||i||(i=!0,t.writeHead(200,{"Content-Type":"text/txt"}),fs.readFile(file[0]+"/_txt/"+n,(function(e,n){if(e)throw t.writeHead(404),t.end(),e;t.write(n),t.end()}))),-1==e.url.indexOf(".js")||i||(i=!0,t.writeHead(200,{"Content-Type":"text/javascript"}),fs.readFile(__dirname+"/"+n,(function(e,n){if(e)throw t.writeHead(404),t.end(),e;t.write(n),t.end()}))),-1==e.url.indexOf(".css")||i||(i=!0,t.writeHead(200,{"Content-Type":"text/css"}),fs.readFile(__dirname+"/../_css/"+n,(function(e,n){if(e)throw t.writeHead(404),t.end(),e;t.write(n),t.end()}))),(-1!=n.indexOf("item")&&!i||-1!=n.indexOf("i")&&!i)&&(i=!0,t.writeHead(200,{"Content-Type":"text/html"}),fs.readFile(__dirname+"/../html/item.html",(function(e,n){if(e)throw t.writeHead(404),t.end(),e;t.write(n),t.end()}))),(-1!=n.indexOf("bg")&&!i||-1!=n.indexOf("box_group")&&!i||-1!=n.indexOf("boxgroup")&&!i)&&(i=!0,t.writeHead(200,{"Content-Type":"text/html"}),fs.readFile(__dirname+"/../html/box_group.html",(function(e,n){if(err)throw t.writeHead(404),t.end(),err;t.write(n),t.end()}))),(-1!=n.indexOf("box")&&!i||-1!=n.indexOf("b")&&!i)&&(i=!0,t.writeHead(200,{"Content-Type":"text/html"}),fs.readFile(__dirname+"/../html/box.html",(function(e,n){if(err)throw t.writeHead(404),t.end(),err;t.write(n),t.end()}))),i||(t.writeHead(204),t.write("opps this doesn't exist - 404"),t.writeHead(404),t.end())}var html,instructions,box,box_box,inner_box,item,unused_item,server1=http.createServer(fserverhandler),io1=require("socket.io")(server1);if(server1.listen(server_port1,ip),console.log("Server1 is listening on "+ip+":"+server_port1),io1.sockets.setMaxListeners(100),io1.on("connection",(e=>{reload_data(),iohandle(e)})),"true"===file[3]){var server2=http.createServer(fserverhandler),io2=require("socket.io")(server2);server2.listen(server_port2,file[4]),console.log("Server2 is listening on "+file[4]+":"+server_port2),io2.sockets.setMaxListeners(100),io2.on("connection",(e=>{reload_data(),iohandle(e)}))}function openprompt(e,t,n){return!0}var Users,documents=[];function reload_data(){sql.recreateDb((function(e){sql.read(e,"SELECT * FROM User LEFT JOIN (Userpages LEFT JOIN HTML_pages ON Userpages.HTML_name=HTML_pages.name) ON User.id = Userpages.User",(function(e){Users=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM box_box",(function(e){box_box=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM item ORDER BY name ASC",(function(e){unused_item=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM box b LEFT JOIN box_box b_b ON b.id = b_b.inner_box_id WHERE b_b.inner_box_id IS NULL OR b_b.inner_box_id = '' ORDER BY b.id ASC",(function(e){inner_box=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM HTML_pages ORDER BY position ASC",(function(e){html=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM instructions ORDER BY name ASC",(function(e){(instructions=e).forEach((e=>{if(""==e.document){let t=fs.readFileSync(__dirname+"/../user_data/_txt/"+e.document).toString();documents=[...documents,t,e.id]}}))}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM box ORDER BY name ASC",(function(e){box=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM item ORDER BY name ASC",(function(e){item=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM size_unit ORDER BY multiplicator ASC",(function(e){size_unit=e}))})),sql.recreateDb((function(e){sql.read(e,"SELECT * FROM weight_unit ORDER BY multiplicator ASC",(function(e){weight_unit=e}))}))}sql.setdata(pages,size_unitlist,weight_unitlist,file[0]),sql.initDB((()=>{reload_data()}));var in_use_box_node_data=[];function iohandle(e){var t=e.handshake.address;ip_connections.includes(t)||(console.log("connected client!; ip: "+t),ip_connections+=t),e.emit("getitem",item),e.emit("getbox",box),e.emit("getouterbox",box),e.emit("getinnerbox",inner_box),e.emit("unused_getitem",unused_item),e.emit("getinstructions",instructions),e.emit("html",html),e.emit("getsettings",file),e.emit("getsize_Unit",size_unit),e.emit("getweight_Unit",weight_unit),e.emit("getdocuments",documents),e.on("login",(e=>{})),e.on("setboxpic",(t=>{setobjpic(t,e,!1)})),e.on("setitempic",(t=>{setobjpic(t,e,!0)})),e.on("setfile",(t=>{fs.writeFile(__dirname+"/../user_data/_txt/"+t[0],Buffer.from(t[1]),(function(n){if(n)throw n;e.emit("set_f"+t,!0)}))})),e.on("getfile",(t=>{let n=fs.readFileSync(__dirname+t).toString();e.emit("get_f"+t,n)})),e.on("getinstructions",(t=>{sql.recreateDb((n=>{sql.read(n,"SELECT * FROM instructions WHERE id='"+t+"'",(n=>{e.emit("get_inst"+t,n)}))}))})),e.on("getItem_data",(t=>{sql.recreateDb((n=>{sql.read(n,"SELECT * FROM item i LEFT JOIN(item_sizes isz LEFT JOIN(item_sizes_box isb LEFT JOIN box b ON b.id=isb.box_id)ON isb.item_sizes_id = isz.id)ON isz.item_id=i.id WHERE i.id='"+t+"' ORDER BY b.id ASC",(n=>{e.emit("item"+t,n)}))}))})),e.on("getBox_data",(t=>{sql.recreateDb((n=>{sql.read(n,"SELECT b.weight b_weight, b.id b_id, b.name b_name, b.box_group_id bg_id, b.color b_color, b.picture b_picture, ib.item_id ib_item_id, ib.quantity ib_quantity, i.id i_id, i.name i_name, i.price i_price, i.weight i_weight, i.color i_color, i.picture i_picture FROM Box b LEFT JOIN (item_box ib LEFT JOIN item i ON ib.item_id = i.id) ON b.id = ib.box_id WHERE b.id='"+t+"' ORDER BY b.box_group_id ASC",(n=>{e.emit("box"+t,n)}))}))})),e.on("sql_read",(t=>{sql.recreateDb((n=>{sql.read(n,t,(n=>{e.emit("sql_r"+t,n)}))}))})),e.on("sql_insert",(t=>{sql.insert(t[0],t[1],(()=>{reload_data(),e.emit("sql_i"+t,!0)}))})),e.on("sql_delete",(t=>{sql.delete(t,(()=>{reload_data(),e.emit("sql_d"+t,!0)}))})),e.on("in_use_box_node",(t=>{(in_use_box_node_data=[...in_use_box_node_data,t]).forEach((t=>{getbox_node_items(t,e)}))})),e.on("box_data",(t=>{addbox(t),e.emit("successb",!0)})),e.on("item_data",(n=>{additem(n,e.emit("successi",t))})),e.on("instruction_data",(t=>{addinstruction(t),e.emit("successinst",!0)})),e.on("refresh",(t=>{reload_data(),e.emit("reloaded",t)})),e.on("setsettings",(t=>{e.emit("setsettings"+t,setsettings(t))})),e.on("user",(t=>{setuser(t),e.emit("user"+t,t)})),e.on("check_user",(t=>{e.emit("check_user"+t,checkforperm(t))})),e.on("disconnect",(function(){}))}function checkforperm(e){return sql.recreateDb((function(t){sql.read(t,"SELECT * FROM User LEFT JOIN Userpages ON User.id = Userpages.User WHERE User.name = '"+username,(function(t){if(t[0].HTML_name===e[0])return!0}))})),!1}function setuser(e){sql.recreateDb((function(t){sql.read(t,"SELECT * FROM User WHERE name = '"+e[0]+"' ODER BY id ASC",(function(t){Array.prototype.forEach.call(t,(t=>{bcrypt.compare(e[1],t,(function(t,n){if(t)throw t;n&&(username=e[0],password=e[1],temporary=e[2])}))}))}))}))}function adduser(e){}function setobjpic(e,t,n){console.log(e);let i,o=e[0],l=parseInt(e[2]);t.emit("pready"+o+"&"+e[1],0),t.on("pback"+o+"&"+e[1],(n=>{i+=n[1],i.length+1<=l?t.emit("pready"+o+"&"+e[1],parseInt(n[0])+1):t.emit("ptransferred"+o+!1+"&"+e[1],!1)})),t.once("ptransferred"+o+!0+"&"+e[1],(l=>{t.removeAllListeners("pback"+o+"&"+e[1]),!0===l&&(i.length>=0?sql.recreateDb((function(l){sql.read(l,"SELECT * FROM item WHERE item.name ='"+e[1]+"' ORDER BY id DESC",(e=>{if(n){let n=idu.decode(i);fs.writeFile(__dirname+"/../user_data/_img/item+i="+e[0].id+"."+n.imageType.slice(n.imageType.indexOf("/")+1,n.imageType.length),n.dataBuffer,(function(n){if(n)throw console.log(n),n;let i=["item+i="+e[0].id+".png",__dirname+"/../user_data/_img/item+i="+e[0].id+".png"];sql.insert("INSERT OR IGNORE INTO picture (name, path) VALUES (?, ?)",i,(n=>{sql.recreateDb((n=>{sql.read(n,"SELECT * FROM picture WHERE name='"+i[0]+"' ORDER BY id DESC",(n=>{let i=[e[0].id,n[0].id];sql.insert("INSERT OR IGNORE INTO item_picture (item_id, picture_id) VALUES (?, ?)",i,(n=>{reload_data(),t.emit("pfin"+o+"&"+e[0].name,!0)}))}))}))}))}))}else fs.writeFile(__dirname+"/../user_data/_img/box+b="+e.id+".jpg",Buffer.from(i),(function(n){if(n)throw console.log(n),n;let i=["box+b="+e.id+".jpg",__dirname+"/../user_data/_img/box+b="+e.id+".jpg"];sql.insert("INSERT OR IGNORE INTO picture (name, path) VALUES (?, ?)",i,(n=>{sql.recreateDb((n=>{sql.read(n,"SELECT * FROM picture WHERE name='"+i[0]+"' ORDER BY id DESC",(n=>{let i=[e.id,n[0].id];sql.insert("INSERT OR IGNORE INTO box_picture (box_id, picture_id) VALUES (?, ?)",i,(n=>{reload_data(),t.emit("pfin"+o+"&"+e.name,!0)}))}))}))}))}))}))})):console.log("no picture data"))}))}function getitem(e,t,n,i){console.log(e),sql.recreateDb((function(o){sql.read(o,"SELECT * FROM item WHERE item.name ='"+e+"' ORDER BY id DESC",(e=>{console.log(1),console.log(e),console.log(e[0]),setobjpic(t,n,i,e[0])}))}))}function getbox(e){sql.recreateDb((function(t){sql.read(t,"SELECT * FROM box i WHERE i.name ='"+e+"' ORDER BY id DESC",(e=>e[0]))}))}function getbox_node_items(e,t){sql.recreateDb((function(n){sql.read(n,"SELECT * FROM item_box ib LEFT JOIN item i ON ib.item_id = i.id WHERE ib.box_id='"+e+"' ORDER BY i.name ASC",(function(n){t.emit(""+e,n)}))}))}function addbox(e){let t=[e[0],e[4],e[5],e[6]];console.log(1),sql.insert("INSERT OR IGNORE INTO box (name, color, weight, location) VALUES (?, ?, ?, ?)",t,(t=>{sql.recreateDb((t=>{sql.read(t,"SELECT * FROM box WHERE name = '"+e[0]+"' ORDER BY id DESC",(t=>{var n=!1;if(!n){for(let n=0;n<e[3].length;n+=2){let i=[e[3][n],parseInt(t[0].id),e[3][n+1]];0!=i[2]&&sql.recreateDb((t=>{sql.read(t,"SELECT * FROM item_box WHERE item_id='"+e[3][n]+"' AND box_id='1' ORDER BY id DESC",(t=>{console.log(2),sql.insert("INSERT OR IGNORE INTO item_box (item_id, box_id, quantity) VALUES (?, ?, ?)",i,(i=>{sql.insert("UPDATE item_box SET quantity='"+(t[0].quantity-e[3][n+1])+"' WHERE item_id='"+e[3][n]+"' AND box_id='1'",[],(e=>{reload_data()}))}))}))}))}for(let n=0;n<e[2].length;n+=1){let i=[e[2][n],parseInt(t[0].id)];console.log(3),sql.insert("INSERT OR IGNORE INTO box_box (inner_box_id, outer_box_id) VALUES (?, ?)",i,(e=>{reload_data()}))}let i=[e[1],parseInt(t[0].id)];console.log(4),sql.insert("INSERT OR IGNORE INTO box_box (inner_box_id, outer_box_id) VALUES (?, ?)",i,(e=>{reload_data()})),n=!0}}))}))}))}function addinstruction(e){let t=[e[0]];sql.insert("INSERT OR IGNORE INTO instructions (name) VALUES (?)",t,(t=>{sql.recreateDb((t=>{sql.read(t,"SELECT * FROM instructions WHERE name = '"+e[0]+"' ORDER BY id DESC",(t=>{var n=!1;if(!n){for(let n=0;n<e[2].length;n++){let i=[];sql.insert("UPDATE item SET instructions_id ='"+t[0].id+"' WHERE id = '"+parseInt(e[1][n])+"'",i,(e=>{reload_data()}))}n=!0}0!=e[3]&&fs.writeFile(__dirname+"/../user_data/_txt/"+t[0].id+".txt",Buffer.from(e[2]),(function(e){if(e)throw e;sql.insert("UPDATE instructions SET document ='"+t[0].id+".txt' WHERE id = '"+t[0].id+"'",[],(e=>{}))}))}))}))}))}function additem(e,t){let n=[e[0],e[2],e[4]];console.log(n),sql.insert("INSERT OR IGNORE INTO item (name, instructions_id, color) VALUES (?, ?, ?)",n,(t=>{reload_data(),sql.recreateDb((t=>{sql.read(t,"SELECT * FROM item WHERE name ='"+e[0]+"' ORDER BY id DESC",(t=>{for(let n=0;n<e[5].length;n++){let i=[t[0].id,e[3][n],e[5][n],e[7][n],e[6][n]];console.log(e),sql.insert("INSERT OR IGNORE INTO item_sizes (item_id, size, total_quantity, price, weight) VALUES (?, ?, ?, ?, ?)",i,(i=>{reload_data(),sql.recreateDb((i=>{sql.read(i,"SELECT * FROM item_sizes_box WHERE item_sizes_id ='"+t[0].id+"' AND Box_id='1' ORDER BY id DESC",(i=>{0==i.length?sql.recreateDb((i=>{sql.read(i,"SELECT * FROM item_sizes WHERE item_id ='"+t[0].id+"' AND size='"+e[3][n]+"' ORDER BY id DESC",(t=>{let i=[t.id,e[1][n],e[5][n]];sql.insert("INSERT OR IGNORE INTO item_sizes_box (item_sizes_id, box_id, quantity) VALUES (?, ?, ?)",i,(e=>{reload_data()}))}))})):i.length>1&&(console.log("An error occured"),reload_data())}))}))}))}}))}))}))}function setsettings(e){var t=[""!=e[0]&&null!=e[0]?e[0]:file[0],""!=e[1]&&null!=e[1]?e[1]:file[1],""!=e[2]&&null!=e[2]?e[2]:file[2],e[3]+"",""!=e[4]&&null!=e[4]?e[4]:file[4],""!=e[5]&&null!=e[5]?e[5]:file[5],""!=e[6]&&null!=e[6]?e[6]:file[6]];let n=fs.readFileSync(__dirname+"/../settings.txt","utf-8").toString().split(/\r?\n/),i=n.slice(),o=0;for(let e=0;e<i.length;e++){-1!=i[e].indexOf("#")&&(n.splice(e,1,"#"+t[o]),o+=1)}return file=t,sql.setdata(pages,size_unitlist,weight_unitlist,file[0]),server1.close(),server2.close(),ip_connections=[],server_port1=process.env.PORT||file[2],server_port2=process.env.PORT||file[5],server1.listen(server_port1,ip),console.log("Server1 is listening on "+ip+":"+server_port1),io1.on("connection",(e=>{reload_data(),iohandle(e)})),"true"===file[3]&&(server2.listen(server_port2,file[4]),console.log("Server2 is listening on "+file[4]+":"+server_port2),io2.on("connection",(e=>{reload_data(),iohandle(e)}))),fs.writeFile(__dirname+"/../settings.txt",n.join("\r\n"),(function(e){if(e)throw e})),[ip,server_port1]}function opentab(e,t){var n,i,o;for(i=document.getElementsByClassName("tabcontent"),n=0;n<i.length;n++)i[n].style.display="none";for(o=document.getElementsByClassName("tablinks"),n=0;n<o.length;n++)o[n].className=o[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}function getsettings(){var e=location.host,t=io("http://"+e,{transports:["websocket"]});t.on("connect",(()=>{t.on("getsettings",(e=>{console.log(e),document.getElementById("database_location").placeholder=e[0],document.getElementById("database_location").title=e[0],document.getElementById("server_1_ip").placeholder=e[1],document.getElementById("server_1_port").placeholder=e[2],"true"===e[3]?(document.getElementById("server_2_use_true").checked=!0,toggle(!0)):(document.getElementById("server_2_use_false").checked=!0,toggle(!1)),document.getElementById("server_2_ip").placeholder=e[4],document.getElementById("server_2_port").placeholder=e[5],settings_load=!0}))}))}function toggle(e){document.getElementById("collapseOne").style.display=e?"block":"none"}function setsettings(){var e=location.host,t=[document.getElementById("database_location").value,document.getElementById("server_1_ip").value,document.getElementById("server_1_port").value,document.getElementById("server_2_use_true").checked,document.getElementById("server_2_ip").value,document.getElementById("server_2_port").value];console.log(t);var n=io("http://"+e,{transports:["websocket"]});n.on("connect",(()=>{n.emit("setsettings",t),n.on("setsettings"+t,(e=>{location.reload()}))}))}function getusers(){var e=location.host,t=io("http://"+e,{transports:["websocket"]});t.on("connect",(()=>{t.on("get",settings)}))}document.addEventListener("DOMContentLoaded",(function(){new Swiper(".swiper-container",{loop:!0,pagination:{el:".swiper-pagination",clickable:!0},paginationClickable:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}));const{values:values}=require("underscore"),sqlite3=require("sqlite3").verbose();var db,size_unit,weight_unit,file="";function createDb(){db=new sqlite3.Database(file,(e=>{e?console.log(e):createTables()})),console.log("database connected at: "+file)}function recreateDb(e){e(new sqlite3.Database(file))}function createTables(){db.run("CREATE TABLE IF NOT EXISTS version (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, version STRING (200) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS box (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (200) NOT NULL UNIQUE, color STRING (200), weight INTEGER (100), location STRING (200));"),db.run("CREATE TABLE IF NOT EXISTS box_box (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, inner_box_id INTEGER (100) NOT NULL REFERENCES box (id), outer_box_id INTEGER (100) NOT NULL REFERENCES box (id));"),db.run("CREATE TABLE IF NOT EXISTS in_use (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, item_sizes_id INTEGER  NOT NULL REFERENCES item_sizes (id), box_id   INTEGER (100) NOT NULL REFERENCES box (id), location STRING (100), quantity INTEGER (100) NOT NULL, notes STRING (100));"),db.run("CREATE TABLE IF NOT EXISTS instructions (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (100) NOT NULL UNIQUE, txtdocument STRING (200), pdfdocument_path STRING (200));"),db.run("CREATE TABLE IF NOT EXISTS item (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (100) NOT NULL UNIQUE, instructions_id INTEGER (100) REFERENCES instructions (id), color STRING (200));"),db.run("CREATE TABLE IF NOT EXISTS item_sizes (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, item_id INTEGER NOT NULL REFERENCES item (id), size INTEGER (100), total_quantity INTEGER (100) NOT NULL, price INTEGER (100), weight INTEGER (100), IP STRING (40));"),db.run("CREATE TABLE IF NOT EXISTS item_sizes_box (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, item_sizes_id INTEGER NOT NULL REFERENCES item_sizes (id), box_id INTEGER (100) REFERENCES box (id) NOT NULL, quantity INTEGER (100) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS item_picture (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, item_id INTEGER NOT NULL REFERENCES item (id), picture_id INTEGER (100) REFERENCES picture (id) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS box_picture (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, box_id INTEGER NOT NULL REFERENCES box (id), picture_id INTEGER (100) REFERENCES picture (id) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS picture (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING(200) NOT NULL, path STRING (200) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS event (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, item_id INTEGER NOT NULL REFERENCES item (id), quantity INTEGER (100) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS HTML_pages (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (100) NOT NULL UNIQUE, path STRING (200) NOT NULL UNIQUE, position INTEGER (100)  NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS Userpages (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, HTML_name STRING NOT NULL REFERENCES HTML_pages (name), User INTEGER NOT NULL REFERENCES User (id));"),db.run("CREATE TABLE IF NOT EXISTS User (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (100) NOT NULL UNIQUE, password STRING (100), level INTEGER (100), canchangeIV INTEGER (100));"),db.run("CREATE TABLE IF NOT EXISTS size_unit (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (100) NOT NULL UNIQUE, multiplicator INTEGER (100) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS connection (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (100) NOT NULL UNIQUE, gender BIT NOT NULL, note STRING (200));"),db.run("CREATE TABLE IF NOT EXISTS connection_copatible (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, connection_id INTEGER NOT NULL REFERENCES connection (id), compatible_id INTEGER NOT NULL REFERENCES connection (id));"),db.run("CREATE TABLE IF NOT EXISTS connection_item_sizes (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, connection_id INTEGER NOT NULL REFERENCES connection (id), item_sizes_id INTEGER NOT NULL REFERENCES item_sizes (id), count INTEGER (100) NOT NULL);"),db.run("CREATE TABLE IF NOT EXISTS weight_unit (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL UNIQUE, name STRING (100) NOT NULL UNIQUE, multiplicator INTEGER (100) NOT NULL);",closeDb(!1,db))}function insertunit(){for(var e=0;e<size_unit.length;e+=2)recreateDb((function(t){var n=t.prepare("INSERT OR IGNORE INTO size_unit (name, multiplicator) VALUES (?, ?)");n.run(size_unit[e],size_unit[e+1]),n.finalize((()=>{closedb(t)}))}));for(e=0;e<weight_unit.length;e+=2)recreateDb((function(t){var n=t.prepare("INSERT OR IGNORE INTO weight_unit (name, multiplicator) VALUES (?, ?)");n.run(weight_unit[e],weight_unit[e+1]),n.finalize((()=>{closedb(t)}))}));insertdefaults()}function insertdefaults(){insert("INSERT OR IGNORE INTO box (id, name, color) VALUES (?, ?, ?)",[1,"default","#FFFFFF"],(e=>{insert("INSERT OR IGNORE INTO User (id, name, password, level, canchangeIV) VALUES (?, ?, ?, ?, ?)",[1,"admin","","0","1"],(e=>{insert("INSERT OR IGNORE INTO User (id, name, password, level, canchangeIV) VALUES (?, ?, ?, ?, ?)",[2,"standard","","1","0"],(e=>{insert("INSERT OR IGNORE INTO Userpages (HTML_name, User) VALUES (?, ?)",["settings",2],(e=>{insert("INSERT OR IGNORE INTO version (id, version) VALUES (?, ?)",[1,"IM 1.0.0"],(e=>{}))}))}))}))}))}function insert(e,t,n){recreateDb((function(i){var o=i.prepare(e);o.run(...t),o.finalize((()=>{closedb(i,n(!0))}))}))}function deletesql(e,t){recreateDb((function(n){var i=n.prepare(e);i.run(),i.finalize((()=>{closedb(n),t(!0)}))}))}function readAllRows(e){db.all("SELECT * FROM HTML_pages",(function(t,n){e&&n.forEach((function(e){console.log(e.HTML_id+": "+e.name+", "+e.path)})),closedb(!1,db)}))}function initDB(e){createDb()}function closedb(e){e.close()}function closedb(e,t){e.close()}function closeDb(e,t){e?t.close():t.close((()=>{let e=0;pages.forEach((t=>{insert("INSERT OR IGNORE INTO HTML_pages (name, path, position) VALUES (?, ?, ?)",[t,t+".html",e],(()=>{})),e+=1})),insertunit()}))}function closedbcall(e,t){e.close(t)}function setdata(e,t,n,i){pages=e,size_unit=t,weight_unit=n,file=i+"/inventory.db"}function read(e,t,n){e.all(t,(function(t,i){closedb(e),n(i)}))}module.exports=function(e,t,n,i,o){var l={read:function(e,t,n){read(e,t,n)},setdata:function(e,t,n,i){setdata(e,t,n,i)},initDB:function(e){initDB(e)},recreateDb:function(e){recreateDb(e)},closedb:function(e){closedb(e)},insert:function(e,t,n){insert(e,t,n)},delete:function(e,t){deletesql(e,t)}};return l};